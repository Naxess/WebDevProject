<!DOCTYPE html>
{% extends 'base_template_languageguides.html' %}

{% load static %}

{% block head_block %}
<title>Django - Model Queries</title>
<link rel="stylesheet" href="{% static 'css/django_model_queries.css' %}">
<link rel="stylesheet" href="{% static 'css/global_styling.css' %}">
<link rel="stylesheet" href="{% static 'css/effects_styling.css' %}">
{% endblock %}

{% block body_block %}
<a id="django_model_queries_anchor"><h1>Django <span class="door">-</span> Model Queries</h1></a>
<div class="form-control">
    <div class="form-control mt-1 mb-2">
        <a id="example_modelspy_id"><h4>Example models.py</h4></a>
        <p>Other examples in this guide may reference this one.</p>
        <pre class="mb-1">
from datetime import date
from django.db import models

class Blog(models.Model):
    name = models.CharField(max_length=100)
    tagline = models.TextField()

    def __str__(self):
        return self.name

class Author(models.Model):
    name = models.CharField(max_length=100)
    email = models.EmailField()

    def __str__(self):
        return self.name

class Entry(models.Model):
    blog = models.ForeignKey(Blog, on_delete=models.CASCADE)
    headline = models.CharField(max_length=255)
    body_text = models.TextField()
    pub_date = models.DateField()
    mod_date = models.DateField(default=date.today)
    authors = models.ManyToManyField(Author)
    number_of_comments = models.IntegerField(default=0)
    number_of_pingbanks = models.IntegerField(default=0)
    rating = models.IntegerField(default=5)

    def __str__(self):
        return self.headline
</pre>
    </div>

    <div class="form-control mb-2">
        <a id="creating_objs_anchor"><h3>Creating Objects</h3></a>
        <p class="mb-1">
            To represent database-table data in Python objects, Django uses an intuitive system: A model class
            represents a database table, and an instance of that class represents a particular record in the database
            table.
            <br><br>
            To create an object, instantiate it using keyword arguments to the model class, then call <em>save()</em> to
            save it to the database.
        </p>
        <pre>
    from blog.models import Blog
    b = Blog(name="Beetles' Blog", tagline="Life of a Tank Bug")
    b.save()
</pre>
        <p class="mb-1">
            This performs an <em>INSERT</em> SQL statement behind the scenes. The entry is not added to the database
            until the <em>save()</em> function is called.
        </p>
    </div>

    <div class="form-control mb-2">
        <a id="update_objs_anchor"><h3>Saving Changes to Objects (AKA Updating)</h3></a>
        <p class="my-1">
            To save changes to an object that's already in the database, use the <em>save()</em> function.
        </p>
        <pre>
    b2 = Blog(name="Ladybug Blog", tagline="Ladybug Thoughts")
    b2.name = "Bug Lady's Blog"
    b2.save()
</pre>
        <p>
            This performs an <em>UPDATE</em> SQL statement behind the scenes. Django doesn't update the database until
            the <em>save()</em> function is called.
        </p>

        <div class="form-control mb-1">
            <a id="save_foreignkey_manytomany_fields_anchor"><h4>Saving <em>ForeignKey</em> and <em>ManyToManyField</em>
                Fields</h4></a>
            <p class="my-1">
                Updating a <em>ForeignKey</em> field works exactly the same way as saving a normal field - assign an
                object of the right type to the field in question. This example updates the <em>blog</em> attribute of
                an <em>Entry</em> instance <u>entry</u>, assuming appropriate instances of <em>Entry</em> and
                <em>Blog</em> are already saved to the database. Example:
            </p>
            <pre>
    from blog.models import Blog, Entry

    entry = Entry.objects.get(pk=1)
    cheese_blog = Blog.objects.get(name="Cheddar Talk")
    entry.blog = cheese_blog
    entry.save()
</pre>
            <p class="my-1">
                Updating a <em>ManyToManyField</em> works a little different from <em>ForeignKey</em>. We need to use
                the <em>add()</em> method on the field to add a record to the relation. This example adds the
                <em>Author</em> instance <u>joe</u> to the <u>entry</u> object:
            </p>
            <pre>
    from blog.models import Author

    joe = Author.objects.create(name="Joe")
    entry.authors.add(joe)
</pre>
            <p class="my-1">
                To add multiple records to a <em>ManyToManyField</em> in a single go, we can include multiple arguments
                in the call to the <em>add()</em> method, like so:
            </p>
            <pre>
    john = Author.objects.create(name="John")
    paul = Author.objects.create(name="Paul")
    george = Author.objects.create(name="George")
    ringo = Author.objects.create(name="Ringo")

    entry.authors.add(john, paul, george, ringo)
</pre>
            <p class="mb-1">Note that Django will throw an exception if you attempt to add an object of the wrong
                type.</p>
        </div>
    </div>

    <div class="form-control mb-1">
        <a id="manager_anchor"><h3>Using the <em>Manager (objects)</em></h3></a>
        <p class="mb-1">
            To retrieve objects from the database, construct a <em>QuerySet</em> via a <em>Manager</em> on your model
            class.
            <br><br>
            A <em>QuerySet</em> represents a collection of objects from your database. It can have zero, one, or
            many <em>filters</em>. Filters narrow down the query results based on the given parameters. In SQL terms, a
            <em>QuerySet</em> equates to a <em>SELECT</em> statement, and a filter is a limiting clause such as
            <em>WHERE</em> or <em>LIMIT</em>. See next <a href="#queryset_api_methods_anchor">section</a> for additional
            details.
            <br><br>
            You get a <em>QuerySet</em> by using your model's <em>Manager</em>. Each model has at least one
            <em>Manager</em>, and it's called <em>objects</em> by default. <strong>Access it directly via the model
            <u>class</u></strong>, as seen below:
        </p>
        <pre>
    Blog.objects                            # Returns a django.db.models.manager.Manager object
    b = Blog(name="Foo", tagline="Bar")     # Selects a row that matches the specified values
    b.objects                               # Results in an error.
        # Reminder that the <em>objects</em> manager is only callable by the model <strong>class</strong>
</pre>
        <p>
            The <em>Manager</em> is the main source of <em>QuerySets</em> for a model. For example,
            <em>Blog.objects.all()</em> will return a <em>QuerySet</em> that contains all <em>Blog</em> objects in the
            database.
        </p>

        <div class="form-control mb-2">
            <a id="retrieve_all_objs_anchor"><h4>Retrieving All Objects - Using <em>all</em></h4></a>
            <p class="mb-1">
                To retrieve ALL objects from a table is to use the <em>all()</em> method on a <em>Manager</em>. Example:
            </p>
            <pre>
    all_entries = Entry.objects.all()
</pre>
            <p class="my-1">
                The <em>all()</em> method returns a <em>QuerySet</em> of all the objects in the database.
            </p>
        </div>

        <div class="form-control mb-2">
            <a id="filter_method_anchor">
                <h4>Retrieving/Filtering Specific Objects - Using <em>filter</em> and <em>exclude</em></h4>
            </a>
            <p class="mb-1">
                The <em>QuerySet</em> returned by the <em>all()</em> method describes all objects in the database table.
                If we only want a subset of those objects, then we can filter the results using the <em>filter()</em> or
                <em>exclude()</em> methods.
            </p>
            <table class="table table-bordered">
                <tr class="table-dark">
                    <th>Method</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <th>filter(**kwargs)</th>
                    <td>Returns a new <em>QuerySet</em> containing objects that match the given lookup parameters.</td>
                </tr>
                <tr>
                    <th>exclude(**kwargs)</th>
                    <td>Returns a new <em>QuerySet</em> containing objects that do <strong>not</strong> match the given
                        lookup parameters.
                    </td>
                </tr>
            </table>
            <p class="mb-1">
                Lookup parameters (**kwargs in the above functions) should be in the following format:
            </p>
            <pre class="mb-0">
    <em>model_class</em>.objects.filter(<em>field_name</em>__<em>lookup_type</em>="<em>value</em>")
</pre>
            <p>
                Note the double underscore ( __ ) between <em>field_name</em> and <em>lookup_type</em>. This is part of
                the syntax - it separates the field/column name from the lookup type (e.g. contains, in, startswith,
                endswith, etc..). See full list of field lookups <a href="#field_lookups_anchor">here</a>.
            </p>
            <p class="my-1">
                Example keyword argument:
            </p>
            <pre class="mb-0">
    Entry.objects.filter(pub_date__lte="2024-01-01")    # 'lte' == 'Less Than or Equal To'
</pre>
            <p class="my-0">is comparable to the below SQL statement:</p>
            <pre>
    SELECT * FROM blog_entry WHERE pub_date <= '2024-01-01';
</pre>

            <div class="form-control mb-2">
                <a id="chaining_filters_anchor"><h5>Chaining Filters</h5></a>
                <p class="mb-0">
                    The result of refining a <em>QuerySet</em> is itself a <em>QuerySet</em>, so it's possible to chain
                    refinements together, like so:
                </p>
                <pre class="mb-1">
    Entry.objects.filter(headline__startswith="What")
                 .exclude(pub_date__gte=datetime.date.today())
                 .filter(pub_date__gte=datetime.date(2005,1,30))
</pre>
                <p>
                    This takes the initial <em>QuerySet</em> of all entries in the database, applies a filter, then an
                    exclusion, then another filter. The final result is a <em>QuerySet</em> containing all entries with
                    a <em>headline</em> that starts with "What", that were published between 1/30/2005 and the current
                    day.
                </p>
            </div>

            <div class="form-control mb-2">
                <a id="filtered_queryset_unique_anchor"><h5>Filtered QuerySets are unique</h5></a>
                <p class="mb-1">
                    <strong>Filtered <em>QuerySets</em> are <u>unique</u></strong>, meaning each time you refine a
                    <em>QuerySet</em>, you get a brand new QuerySet that is in no way bound to the previous QuerySet.
                    Each refinement creates a separate and distinct QuerySet that can be stored, used and reused.
                    <br>
                    Example:
                </p>
                <pre class="mb-1">
    q1 = Entry.objects.filter(headline__startswith="What")
    q2 = q1.exclude(pub_date__gte=datetime.date.today())
    q3 = q1.filter(pub_date__gte=datetime.date.today())
</pre>
                <p class="mb-1">
                    These three QuerySets are separate. The first is a base QuerySet containing all entries that contain
                    a headline starting with "What". The second is s subset of the first, with an additional criteria
                    that excludes records whose <em>pub_date</em> is today or in the future. The third is a subset of
                    the first, with an additional criteria that selects only those records whose <em>pub_date</em> is
                    today or in the future. The intiial QuerySet is unaffected by the refinement process.
                </p>
            </div>

            <div class="form-control mb-1">
                <a id="lazy_querysets_anchor"><h5>QuerySets are lazy</h5></a>
                <p class="mb-1">
                    <strong>QuerySets are <u>lazy</u></strong>, meaning that the act of creating a QuerySet doesn't
                    involve any database activity. You can stack filters together all day long, and Django won't
                    actually run the query until the QuerySet is evaluated. See below example:
                </p>
                <pre class="mb-0">
    q = Entry.objects.filter(headline__startswith="What")
    q = q.filter(pub_date__lte=datetime.date.today())
    q = q.exclude(body_text__icontains="food")
    print(q)
</pre>
                <p class="mb-1">
                    Although it appears like three database hits, the database is in fact only hit once, on the
                    <em>print</em> statement. In general, the results of a QuerySet aren't fetched from the database
                    until it is explicitly asked for. When it is asked for, the QuerySet is evaluated by accessing the
                    database. See section: <a href="#anchor_evaluating_querysets">Evaluating QuerySets</a>
                </p>
            </div>
        </div>

        <div class="form-control mb-2">
            <a id="single_obj_retrieval_anchor"><h4>Retrieving a Single Object with <em>get</em></h4></a>
            <p class="mb-1">
                <em>filter()</em> will always return a QuerySet, even if only a single object matched the query. If we
                know that only a single object will match our query - we can use <em>get()</em> on the <em>Manager</em>
                to return the object directly. See example below:
            </p>
            <pre class="mb-0">
    one_entry = Entry.objects.get(pk=1)
</pre>
            <p class="mb-1">
                The <em>get()</em> method can also accept query expressions (see
                <a href="#field_lookups_anchor">Field Lookups</a>). Note: there is a difference between using
                <em>get()</em> and using <em>filter()</em> with slice of <em>[0]</em>. If there are no results that
                match the query, then <em>get()</em> will raise a <em>DoesNotExist</em> exception. Similarly, if more
                than one item matches the <em>get()</em> query, then Django will raise a
                <em>MultipleObjectsReturned</em> exception. Both exceptions are attributes of the model class itself.
            </p>
        </div>

        <div class="form-control mb-2">
            <a id="queryset_api_methods_anchor"><h4>QuerySet API</h4></a>
            <p>
                As mentioned in the previous section, a <em>QuerySet</em> represents a collection of objects from your
                database. A major advantage of using QuerySets are all of the built-in methods for filtering and
                ordering the data.
            </p>
            <p class="mb-1">Formal declaration of a <em>QuerySet</em>:</p>
            <pre>class QuerySet(model=None, query=None, using=None, hints=None)</pre>
            <p class="mb-1">QuerySet public attributes for introspection:</p>
            <table class="table table-bordered">
                <tr class="table-dark">
                    <th>Attribute</th>
                    <th>Description</th>
                    <th>Example usage</th>
                </tr>
                <tr>
                    <th>ordered</th>
                    <td>Returns <u>True</u> if the QuerySet is ordered (i.e. has an <em>order_by()</em> clause or
                        default ordering), else <u>False</u>.
                    </td>
                    <td>QuerySet.ordered</td>
                </tr>
                <tr>
                    <th>db</th>
                    <td>The database that will be used if this query is executed now.</td>
                    <td><span class="unfamiliar_topic">QuerySet.db</span></td>
                </tr>
            </table>

            <div class="accordion mb-2">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapse_queryset_returning_methods">
                            QuerySet Methods that return new QuerySets
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapse_queryset_returning_methods">
                        <div class="accordion-body">
                            <div class="container-fluid">
                                <table class="table table-bordered">
                                    <tr class="table-dark">
                                        <th>Method</th>
                                        <th>Description</th>
                                        <th>Example Usage</th>
                                    </tr>
                                    <tr>
                                        <th>filter()</th>
                                        <td>
                                            <p>filter(*args, **kwargs)</p>
                                            <p>
                                                Returns a new QuerySet that contains objects that match the given lookup
                                                parameters. Further elaboration in this <a href="#filter_method_anchor">
                                                section</a>.
                                            </p>
                                            <p>
                                                The lookup parameters (**kwargs) should be in the format described in
                                                the field lookups reference <a href="#field_lookups_anchor">section</a>.
                                                Multiple parameters are joined via the <em>AND</em> operator in the
                                                underlying SQL statement.
                                            </p>
                                            <p class="mb-1">
                                                More complex queries can be performed with the use of <em>Q()</em>
                                                objects. See this <a href="#q_objects_anchor">section</a>.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.filter(pub_date__lte="2024-01-01")

# Equivalent SQL statement:
SELECT * FROM blog_entry
    WHERE pub_date <= '2024-01-01';
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>exclude()</th>
                                        <td>
                                            <p>exclude(*args, **kwargs)</p>
                                            <p class="mb-1">
                                                Returns a new QuerySet containing objects that don't match the given
                                                lookup parameters. The lookup parameters (**kwargs) should be in the
                                                format described in the field lookups reference
                                                <a href="#field_lookups_anchor">section</a>. Multiple parameters are
                                                joined via the <em>AND</em> operator in the underlying SQL statement,
                                                and the whole thing is enclosed in a <em>NOT()</em>.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.exclude(
    pub_date__gt=datetime.date(2005,1,3),
    headline="Hello")

# Equivalent SQL statement:
SELECT ... WHERE NOT (pub_date > '2005-1-3'
                      AND headline = 'Hello');
</pre>
                                            <hr class="mt-1">
                                            <pre class="mb-1">
Entry.objects
    .exclude(pub_date__gt=datetime.date(2005,1,3))
    .exclude(headline="Hello")

# Equivalent SQL statement:
SELECT ... WHERE NOT pub_date > '2005-1-3'
                AND NOT headline = 'Hello';
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>annotate()</th>
                                        <td>
                                            <p>annotate(*args, **kwargs)</p>
                                            <p class="mb-1">
                                                Annotates each object in the QuerySet with the provided list of query
                                                expressions. An expression may be a simple value, a reference to a field
                                                on the model (or any related models), or an aggregate expression
                                                (averages, sum, etc.) that has been computed over the objects that are
                                                related to the objects in the QuerySet.
                                                <br>
                                                Each argument to <em>annotate()</em> is an annotation that will be added
                                                to each object in the QuerySet that is returned.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
                                                
</pre>
                                    </tr>
                                    <tr>
                                        <th>alias()</th>
                                        <td>
                                            <p>alias(*args, **kwargs)</p>
                                            <p class="mb-1">
                                                Same as <em>annotate()</em>, but instead of annotating objects in the
                                                QuerySet, saves the expression for later reuse with other QuerySet
                                                methods. This is useful when the result of the expression itself is not
                                                needed but it is used for filtering, ordering, or as a part of a complex
                                                expression. Not selecting the unused value removes redundant work from
                                                the database, which can result in better performance. Can be used in
                                                conjunction with <em>annotate()</em>, <em>exclude()</em>,
                                                <em>filter()</em>, <em>order_by()</em>, and <em>update()</em>.
                                                <em>filter()</em> and <em>order_by</em> can take expressions directly
                                                but expression construction and usage often doesn't happen in the same
                                                place. <em>alias()</em> allows building complex expressions
                                                incrementally, possibly spanning multiple methods and modules.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
'''
Gets blogs with more than 5 entries,
while ignoring the exact number of entries:
'''
from django.db.models import Count
blogs = Blog.objects.<mark>alias</mark>(entries=Count("entry"))
                    .filter(entries__gt=5)
</pre>
                                            <pre>
'''
Can be used in conjunction with annotate(),
exclude(), filter(), order_by(), and update():
'''
Blog.objects.<mark>alias</mark>(entries=Count("entry"))
            .annotate(entries=F("entries"))
            .aggregate(Sum("entries"))
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>order_by()</th>
                                        <td colspan="2">
                                            <p>order_by(*fields)</p>
                                            <p class="mb-1">
                                                By default, results returned by a QuerySet are ordered by the ordering
                                                tuple given by the <em>ordering</em> option in the model's <em>Meta</em>.
                                                Below example sorts results by <em>pub_date</em> descending, then by
                                                <em>headline</em> ascending:
                                            </p>
                                            <pre class="mb-1">
Entry.objects.filter(pub_date__year=2005)
             .order_by("-pub_date","headline")
</pre>
                                            <p class="my-1">
                                                In the example above, <em>pub_date</em> is sorted by descending by
                                                appending a negative sign ( - ) to the start of the field name string.
                                                Ascending order is enabled by default and thus requires no modification.
                                                To order the results randomly, simply supply a question mark ( ? )
                                                string, like so:
                                            </p>
                                            <pre class="mt-1">
Entry.objects.order_by("?")
</pre>
                                            <p class="mb-1">
                                                Results can also be ordered by a field in a different model by using the
                                                related models syntax:
                                                <em>&lt;field&gt;</em>__<em>&lt;related_model_field&gt;</em>. Example
                                                usage below:
                                            </p>
                                            <pre>
Entry.objects.order_by("blog__name", "headline")
</pre>
                                            <p class="my-1">
                                                Ordering done in this way will use the default ordering on the related
                                                model, or by the related model's primary key if there is no
                                                <em>Meta.ordering</em> specified. Below examples output identical
                                                results:
                                            </p>
                                            <pre>
Entry.objects.order_by("blog")
Entry.objects.order_by("blog__id")
</pre>
                                            <p class="mb-1">
                                                If <em>Blog</em> has <em>ordering=['name']</em>, then the first queryset
                                                would be identical to:
                                            </p>
                                            <pre>
Entry.objects.order_by("blog__name")
</pre>
                                            <p class="mb-1">
                                                The items can also be ordered by query expression by calling
                                                <em>asc()</em> or <em>desc()</em> on the expression. For null values, we
                                                can sort them first or last by editing the <em>nulls_first</em> or
                                                <em>nulls_last</em> arguments (i.e. asc(nulls_first=None,
                                                nulls_last=None)).
                                            </p>
                                            <pre>
Entry.objects.order_by(Coalesce("summary","headline").desc())
</pre>
                                            <p class="mb-1">
                                                There are no options to specify ordering by case-sensitivity. To deal
                                                with case-sensitivity, we can convert fields to upper or lowercase to
                                                achieve case-consistent ordering:
                                            </p>
                                            <pre>
Entry.objects.order_by(Lower("headline").desc())
</pre>
                                            <p class="mb-1">
                                                To remove ordering, call <em>order_by()</em> without supplying any
                                                parameters.
                                                <br>
                                                To check if a query is ordered, we can check the
                                                <em>QuerySet.ordered</em> attribute. If order, it returns <u>True</u>,
                                                else <u>False</u>.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>reverse()</th>
                                        <td>
                                            <p class="mb-1">
                                                The <em>reverse()</em> method reverses the order in which a queryset's
                                                elements are returned.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
my_queryset.reverse()[:5]
</pre>
                                    </tr>
                                    <tr>
                                        <th>distinct()</th>
                                        <td>
                                            <p>distinct(*fields)</p>
                                            <p class="mb-1">
                                                Returns a new QuerySet that uses <em>SELECT DISTINCT</em> in its SQL
                                                query. This eliminates duplicate rows from the query results. By
                                                default, a QuerySet won't eliminate duplicate rows. It's not usually a
                                                problem because basic queries (e.g. Blog.objects.all()) don't introduce
                                                the possibility of duplicate result rows. However, if the query spans
                                                multiple tables, then it's possible to get duplicate results when a
                                                QuerySet is evaluated - this is where the <em>distinct()</em> method is
                                                useful.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Author.objects.distinct()
</pre>
                                    </tr>
                                    <tr>
                                        <th>values()</th>
                                        <td colspan="2">
                                            <p>
                                                values(*fields, **expressions)
                                            </p>
                                            <p class="mb-1">
                                                Returns a QuerySet that returns dictionaries, rather than model
                                                instances when used as an iterable. Each of those dictionaries represent
                                                an object, with the keys corresponding to the attribute names of model
                                                objects.
                                            </p>
                                            <pre>
Blog.objects.filter(name__startswith="Beatles")
>>> &lt;QuerySet[&lt;Blog: Beatles Blog&gt;]&gt;

Blog.objects.filter(name__startswith="Beatles").<mark>values</mark>()
>>> &lt;QuerySet[{'id':1, 'name':'Beatles Blog', 'tagline':'All the latest Beatles news'}]&gt;
</pre>
                                            <p class="mb-1">
                                                The optional positional argument: <em>*field</em>, specifies which field
                                                names that the <em>SELECT</em> should be limited to. If not specified,
                                                then each dictionary will contain a key and value for every field in the
                                                table.
                                            </p>
                                            <pre>
Blog.objects.<mark>values</mark>()
Blog.objects.<mark>values</mark>("id", "name")
</pre>
                                            <p class="mb-1">
                                                Any values passed to the optional argument, <em>**expressions</em>, are
                                                pass into an <em>annotate()</em> call.
                                            </p>
                                            <pre>
from django.db.models.functions import Lower
Blog.objects.values(lower_name=Lower("name")
>>> &lt;QuerySet [{'lower_name': 'beatles blog'}]&gt;
</pre>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>values()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#values">
                                                    here
                                                </a>.
                                            </p>
                                        </td>

                                    </tr>
                                    <tr>
                                        <th>values_list()</th>
                                        <td colspan="2">
                                            <p>
                                                values_list(*fields, flat=False, named=False)
                                            </p>
                                            <p class="mb-1">
                                                Similar to <em>values()</em> but instead of returning dictionaries, it
                                                returns tuples when iterated over. Each tuple contains the value from
                                                the respective field or expression passed into the
                                                <em>values_list()</em> call. If the <em>*fields</em> parameter is
                                                supplied with field arguments, the tuple's items will be displayed in
                                                the order in which the field arguments are supplied. See below example:
                                            </p>
                                            <pre>
Entry.objects.<mark>values_list</mark>("id", "headline")
>>> &lt;QuerySet [(1, 'First entry'), ...]&gt;

from django.db.models.functions import Lower
Entry.objects.<mark>values_list</mark>("id", Lower("headline"))
>>> &lt;QuerySet [(1, 'First entry'), ...]&gt;
</pre>
                                            <p class="mb-1">
                                                In order to enable the <em>flat</em> parameter, the <em>*fields</em>
                                                parameter is only allowed to accept a single field argument, other an
                                                error will occur. Enabling the <em>flat</em> parameter by setting it to
                                                <u>True</u>, will have the results returned as single values, rather
                                                than 1-tuples. See example below:
                                            </p>
                                            <pre>
Entry.objects.values_list("id").order_by("id")
>>> &lt;QuerySet[(1,), (2,), (3,), (4,), (5,), ...]&gt;

Entry.objects.values_list("id", <mark>flat=True</mark>).order_by("id")
>>> &lt;QuerySet[1, 2, 3, 4, 5, ...]&gt;
</pre>
                                            <p class="mb-1">
                                                If we enable the <em>named</em> parameter by setting the value to
                                                <u>True</u>, it will return results as a <em>namedtuple()</em>.
                                            </p>
                                            <pre>
Entry.objects.values_list("id", "headline", <mark>named=True</mark>)
>>> &lt;QuerySet [Row(id=1, headline='First entry'), ...]&gt;
</pre>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>values_list()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#values-list">
                                                    here
                                                </a>.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>dates()</th>
                                        <td>
                                            <p>
                                                dates(field, kind, order='ASC')
                                            </p>
                                            <p>
                                                Returns a QuerySet that evaluates to a list of <em>datetime.date</em>
                                                objects representing all available dates of a particular kind within the
                                                contents of the QuerySet.
                                            </p>
                                            <p>
                                                The <em>field</em> parameter should be the name of a <em>DateField</em>
                                                of the model.
                                            </p>
                                            <p>
                                                The <em>kind</em> parameter should either be <u>"year"</u>,
                                                <u>"month"</u>, <u>"week"</u>, or <u>"day"</u>. Each
                                                <em>datetime.date</em> object in the result list is "truncated" to the
                                                given type. These all return <strong>distinct</strong> values for the
                                                field (i.e. "year" returns all distinct year values, "month" returns
                                                distinct year/month values, etc..)
                                            </p>
                                            <p class="mb-1">
                                                The <em>order</em> parameter, which defaults to <u>'ASC'</u> (for
                                                ascending) can otherwise be set to <u>'DESC'</u> to order by descending.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.dates("pub_date", "year")
>>> [datetime.date(2005, 1, 1)]

Entry.objects.dates("pub_date", "month")
>>> [datetime.date(2005, 2, 1),
     datetime.date(2005, 3, 1)]

Entry.objects.dates("pub_date", "week")
>>> [datetime.date(2005, 2, 14),
     datetime.date(2005, 3, 14)]

Entry.objects.dates("pub_date", "day")
>>> [datetime.date(2005, 2, 20),
     datetime.date(2005, 3, 20)]

Entry.objects.dates("pub_date", "day", order="DESC")
>>> [datetime.date(2005, 3, 20),
     datetime.date(2005, 2, 20)]

Entry.objects.filter(headline__contains="Lennon")
             .dates("pub_date", "day")
>>> [datetime.date(2005, 3, 20)]
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>datetimes()</th>
                                        <td>
                                            <p>
                                                datetimes(field_name, kind, order='ASC', tzinfo=None)
                                            </p>
                                            <p>
                                                Returns a QuerySet that evaluates to a list of
                                                <em>datetime.datetime</em> objects representing all available dates of a
                                                particular kind within the contents of the QuerySet.
                                            </p>
                                            <p>
                                                The <em>field_name</em> parameter should be the name of a
                                                <em>DateTimeField</em> of the model.
                                            </p>
                                            <p>
                                                The <em>kind</em> parameter should be <u>"year"</u>,
                                                <u>"month"</u>, <u>"week"</u>, <u>"day"</u>, <u>"hour"</u>,
                                                <u>"minute"</u>, or <u>"second"</u>. Each <em>datetime.datetime</em>
                                                object in the result list is "truncated" to the given type.
                                            </p>
                                            <p>
                                                The <em>order</em> parameter, which defaults to <u>'ASC'</u> (for
                                                ascending) can otherwise be set to <u>'DESC'</u> to order by descending.
                                            </p>
                                            <p class="mb-1">
                                                The <em>tzinfo</em> defines the time zone to which datetimes are
                                                converted prior to truncation. A given datetime has different
                                                representations depending on the time zone in use. The parameter value
                                                must be a <em>datetime.tzinfo</em> object. If set to <u>None</u>, it
                                                will use the current time zone. No effect if <em>USE_TZ</em> is set to
                                                <u>False</u>.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
                                                
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>none()</th>
                                        <td>
                                            <p class="mb-1">
                                                Calling <em>none()</em> will create a queryset that never returns any
                                                objects and no query will be executed when accessing the results. A
                                                <em>qs.none()</em> queryset is an instance of <em>EmptyQuerySet</em>,
                                                see example:
                                            </p>
                                            <pre class="mb-1">
from django.db.models.query import EmptyQuerySet
isinstance(Entry.objects.none(), EmptyQuerySet)
>>> True
</pre>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.none()
>>> &lt;QuerySet []&gt;
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>all()</th>
                                        <td>
                                            <p>
                                                Returns a <em>copy</em> of the current QuerySet (or QuerySet subclass).
                                                Potentially useful in situations where you want to pass in a model
                                                manager or a QuerySet and do further filtering on the result. After
                                                calling <em>all()</em> on either object, it will return a
                                                <em>QuerySet</em> for use.
                                            </p>
                                            <p class="mb-1">
                                                Evaluating a QuerySet will cache the results. If the database has been
                                                updated since an evaluation has occurred, then we can get updated
                                                results for the same query by calling <em>all()</em> on a previously
                                                evaluated QuerySet.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.all()
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>union()</th>
                                        <td>
                                            <p>
                                                union(*other_qs, all=False)
                                            </p>
                                            <p>
                                                Uses SQL's <em>UNION</em> operator to combine the results of two or more
                                                QuerySets. The <em>UNION</em> operator only selects distinct values by
                                                default. To allow duplicate values, set the <em>all</em> parameter to
                                                <u>True</u>.
                                            </p>
                                            <p>
                                                The <em>UNION</em> operation can be performed on two models as long as
                                                they ahve the same fields or same subset of fields.
                                            </p>
                                            <p class="mb-1">
                                                The returned model instance will be of the first QuerySet, even if the
                                                arguments are QuerySets of other models. Passing different models works
                                                as long as the <em>SELECT</em> list is the same in all QuerySets (at
                                                least the types, the names don't matter as long as the types are in the
                                                same order). In such cases, we need to use column names from the first
                                                QuerySet in QuerySet methods applied to the resulting QuerySet. Example:
                                            </p>
                                            <pre>
qs1 = Author.objects.values_list("name")
qs2 = Entry.objects.values_list("headline")
qs1.union(qs2).order_by("name")
</pre>
                                            <p class="mb-1">
                                                Additional, only <em>LIMIT</em>, <em>OFFSET</em>, <em>COUNT(*)</em>,
                                                <em>ORDER_BY</em>, and specifying columns (i.e. slicing,
                                                <em>count()</em>, <em>exists()</em>, <em>order_by()</em>, and
                                                <em>values()</em>/<em>values_list()</em> are allowed on the resulting
                                                QuerySet. (Note: some databases don't allow LIMIT or OFFSET in combined
                                                queries).
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
author_1 = Author.objects.filter(id__gte=10)
author_2 = Author.objects.filter(id__lte=20)
author_3 = Author.objects.filter(id__exact=100)

author_1.<mark>union</mark>(author_2, author_3)

author_1.union(author_2, author_3, <mark>all=True</mark>)


author_4 = Author.objects.values_list("name")
entry_1 = Entry.objects.values_list("headline")
'''
Note the names are different but both
are of the Charfield type
'''
author_4.union(entry_1)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>intersection()</th>
                                        <td>
                                            <p>
                                                intersection(*other_qs)
                                            </p>
                                            <p class="mb-1">
                                                Uses SQL's <em>INTERSECT</em> operator to return the shared elements of
                                                two or more QuerySets.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
qs1.intersection(qs2, qs3)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>difference()</th>
                                        <td>
                                            <p>
                                                difference(*other_qs)
                                            </p>
                                            <p class="mb-1">
                                                Uses SQL's <em>EXCEPT</em> operator to keep only elements present in the
                                                QuerySet but not in some other QuerySets.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
qs1.difference(qs2, qs3)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>select_related()</th>
                                        <td colspan="2">
                                            <p>
                                                select_related(*fields)
                                            </p>
                                            <p class="mb-1">
                                                Returns a QuerySet that will follow foreign-key relationships, selecting
                                                additional related-object data when it executes its query. This is a
                                                performance booster which results in a single more complex query but
                                                means later use of foreign-key relationships won't require database
                                                queries. Below examples demonstrate the difference between plain lookups
                                                and <em>select_related()</em> lookups.
                                            </p>
                                            <p class="mb-1">Standard lookup:</p>
                                            <pre class="mb-1">
# Hit the database
e = Entry.objects.get(id=5)

# Hits the database again to get the related Blog object
b = e.blog
</pre>
                                            <p class="mb-1"><em>select_related()</em> lookup:</p>
                                            <pre>
# Hits the database
e = Entry.objects.<mark>select_related</mark>("blog").get(id=5)

# Doesn't hit the database, because e.blog has been prepopulated
b = e.blog
</pre>
                                            <p class="mb-1">
                                                <em>select_related()</em> can be used with any queryset of objects, see
                                                example below:
                                            </p>
                                            <pre>
from django.utils import timezone

# Find all the blogs with entries scheduled to be published in the future
blogs = set()

for e in Entry.objects.filter(pub_date__gt=timezone.now()).select_related("blog"):
    '''
        Without select_related(), this would query the database every loop iteration
        in order to fetch the related blog for each entry.
    '''
    blogs.add(e.blog)
</pre>
                                            <p class="mb-1">
                                                The order of filter() and <em>select_related()</em> chaining isn't
                                                important. The below queries are equivalent:
                                            </p>
                                            <pre>
Entry.objects.filter(pub_date__gt=timezone.now()).select_related("blog")
Entry.objects.select_related("blog").filter(pub_date__gt=timezone.now())
</pre>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>select_related()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#select-related">
                                                    here
                                                </a>.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>prefetch_related()</th>
                                        <td colspan="2">
                                            <p>prefetch_related(*lookups)</p>
                                            <p>
                                                Returns a QuerySet that will automatically retrieve, in a single batch,
                                                related objects for each of the specified lookups. It is similar to
                                                <em>select_related()</em>, in that both are designed to stop the deluge
                                                of database queries that is caused by accessing related objects, but the
                                                strategy is quite different.
                                            </p>
                                            <p>
                                                <strong>select_related() vs prefetch_related()</strong>
                                                <br>
                                                <em>select_related()</em> works by creating a SQL join and including the
                                                fields of the related object in the <em>SELECT</em> statement. This
                                                method is limited to single-valued relationships: foreign-key and
                                                one-to-one.
                                                <em>prefetch_related()</em> works by doing a separate lookup for each
                                                relationship, and does the 'joining' in Python. This allows it to
                                                prefetch many-to-many, many-to-one, and <em>GenericRelation</em> objects
                                                which cannot be done using <em>select_related()</em>. It can also
                                                support foreign-key and one-to-one objects.
                                            </p>
                                            <p class="mb-1">
                                                <strong>Retrieval without and with the <em>prefetch_related()</em>
                                                    method.</strong>
                                                <br>
                                                (Below is an example models.py that will be used in the demonstration)
                                            </p>
                                            <pre class="mb-1">
# example models.py
from django.db import models
class Topping(models.Model):
    name = models.CharField(max_length=30)
class Pizza(models.Model):
    name = models.CharField(max_length=30)
    toppings = models.ManyToManyField(Topping)
    def __str__(self):
        return "%s (%s)" % (self.name,
                            ", ".join(topping.name for topping in self.toppings.all()))
</pre>
                                            <p class="mb-1">
                                                Retrieval <u>without</u> <em>prefetch_related()</em>:
                                            </p>
                                            <pre class="mb-1">
Pizza.objects.all()
>>> ["Hawaiian (ham, pineapple)", "Seafood (prawns, smoked salmon)"...
</pre>
                                            <p class="my-1">
                                                The downside is that every time <em>Pizza.__str__()</em> asks for
                                                <em>self.toppings.all()</em>, it has to query the database, so
                                                <em>Pizza.objects.all()</em> must run a query on the Toppings table for
                                                each and every item in the Pizza QuerySet. <em>prefetch_related()</em>
                                                can reduce this to just two queries.
                                            </p>
                                            <p class="mb-1">
                                                Retrieval <u>with</u> <em>prefetch_related()</em>:
                                            </p>
                                            <pre class="mb-1">
Pizza.objects.prefetch_related("toppings")
</pre>
                                            <p class="my-1">
                                                This implies a <em>self.toppings.all()</em> for each <em>Pizza</em>; now
                                                each time <em>self.toppings.all()</em> is called, instead of hitting the
                                                database, it will search for them in the prefetched QuerySet cache that
                                                was populated in a single query. That is, all the relevant toppings will
                                                have been fetched in a single query, and used to make QuerySets that
                                                have a pre-filed cache of relevant results; these QuerySets are then
                                                used in the <em>self.toppings.all()</em> calls.
                                            </p>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>prefetch_related()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#prefetch-related">
                                                    here
                                                </a>.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>extra()</th>
                                        <td>
                                            <p>
                                                extra(select=None, where=None, params=None, tables=None, order_by=None,
                                                select_params=None)
                                            </p>
                                            <p>
                                                <code>
                                                    (Note: This is an old API that is slated for deprecation. Avoid
                                                    using if possible, else use with caution. Escape any parameters that
                                                    the user can control by using <em>params</em> in order to prevent
                                                    SQL injection.)
                                                </code>
                                            </p>
                                            <p>
                                                The <em>extra()</em> QuerySet modifier is a hook for injecting specific
                                                clauses into the SQL generated by a QuerySet.
                                            </p>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>extra()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#extra">
                                                    here.
                                                </a>
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
qs.annotate(val=RawSQL("SELECT col FROM ex_tbl
                                WHERE othercol = %s",
                       (someparam,))
)

# Equivalent statement by using extra()
qs.extra(
    select={"val": "SELECT col FROM ex_tbl
                            WHERE othercol = %s"},
    select_params=(someparam,),
)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>defer()</th>
                                        <td>
                                            <p>
                                                defer(*fields)
                                            </p>
                                            <p>
                                                The <em>defer()</em> method filters out unwanted fields from the query
                                                by not retrieving them. However, some fields cannot be deferred, such as
                                                the primary key, or should not be deferred (e.g. when retrieving
                                                related, you should not defer the connecting field).
                                            </p>
                                            <p>
                                                A query can have multiple calls to <em>defer()</em>, with each new call
                                                adding new fields to the deferred set. The order of the calls and fields
                                                does not matter.
                                            </p>
                                            <p>Fields from related models can also be deferred.</p>
                                            <p>
                                                Passing in <u>None</u> as an argument will clear the "deferred" list and
                                                thus load all fields.
                                            </p>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>defer()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#defer">
                                                    here
                                                </a>.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.defer("headline", "body")

# Multiple defers; order doesn't matter
Entry.objects.defer("body")
             .filter(rating=5)
             .defer("headline")

# Can defer fields from related models
Blog.objects.defer("entry__headline",
                   "entry__body")

# Clears "deferred" list. Loads all fields
my_queryset.defer(None)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>only()</th>
                                        <td>
                                            <p>
                                                only(*fields)
                                            </p>
                                            <p>
                                                The <em>only()</em> method is the opposite of <em>defer()</em> - if
                                                applied to a query, only those fields that are passed in as arguments
                                                will be retrieved - unless those fields are alraedy specified as
                                                deferred (by using the <em>defer()</em>), in which case they won't be
                                                retrieved. If multiple calls to <em>only()</em> are made, only the
                                                fields submitted to the last call will chosen.
                                            </p>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>only()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#only">
                                                    here
                                                </a>.
                                            </p>
                                        </td>
                                        <td>
                                            <pre class="mb-1">
Entry.objects.only("body")

# Retrieves only "headline"
Entry.objects.only("body", "rating")
             .only("headline")

# All fields deferred except "headline"
Entry.objects.only("body", "headline")
             .defer("body")

# Only "headline" is loaded
Entry.objects.defer("body")
             .only("body", "headline")
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>using()</th>
                                        <td>
                                            <p>
                                                using(alias)
                                            </p>
                                            <p class="mb-1">
                                                The <em>using()</em> method is used to control which database the
                                                QuerySet will be evaluated against, if using more than one database. The
                                                only argument this method takes is the alias of a database, as defined
                                                in the <em>DATABASES</em> dictionary in <em>settings.py</em>.
                                            </p>
                                        </td>
                                        <td>
                                            <pre class="mb-1">
# DATABASES dict in example settings.py
...
DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3",
        "NAME": BASE_DIR / "db.sqlite3",
    },
    "number_2": {
        "ENGINE": "django.db.backends.postgresql",
        "NAME": "mydatabase",
        "USER": "mydatabaseuser",
        "PASSWORD": "mypassword",
        "HOST": "127.0.0.1",
        "PORT": "5432",
    }
}
...

# queries the 'default' alias
Entry.objects.all()

# queries the 'number_2' alias
Entry.objects.using("number_2")
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>select_for_update()</th>
                                        <td>
                                            <p>
                                                select_for_update(nowait=False, skip_locked=False, of=(), no_key=False)
                                            </p>
                                            <p>
                                                The <em>select_for_update()</em> method returns a queryset that will
                                                lock rows until the end of the transaction, generating a <em>SELECT ...
                                                FOR UPDATE</em> SQL statement on supported databases.
                                            </p>
                                            <p>
                                                When the queryset is evaluated (e.g. <em>for entry in entries</em>),
                                                all matched entries will be locked until the end of the transaction
                                                block, meaning that other transactions will be prevented from changing
                                                or acquiring locks on them.
                                            </p>
                                            <p class="mb-1">
                                                Additional/advanced content for the <em>select_for_update()</em> method
                                                <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#select-for-update">
                                                    here
                                                </a>.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
from django.db import transaction
entries = Entry.objects.select_for_update()
                       .filter(author=request.user)
with transaction.atomic():
    for entry in entries:
        ...
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>raw()</th>
                                        <td>
                                            <p>
                                                raw(raw_query, params=(), translations=None, using=None)
                                            </p>
                                            <p>
                                                Takes a raw SQL query, executes it, and returns a
                                                <em>django.db.models.query.RawQuerySet</em> instance. This
                                                <em>RawQuerySet</em> instance can be iterated over just like a normal
                                                <em>QuerySet</em> to provide object instances.
                                            </p>
                                            <p>
                                                Warning: <em>raw()</em> always triggers a new query and doesn't account
                                                for previous filtering. As such, it should generally be called from the
                                                <em>Manager</em> or from a fresh <em>QuerySet</em> instance.
                                            </p>
                                            <p class="mb-1">
                                                Refer to this <a href="#raw_sql_anchor">section</a> for additional
                                                information.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
class Person(models.Model):
        first_name = models.CharField(...)
        last_name = models.CharField(...)
        birth_date = models.DateField(...)

for p in Person.objects.<mark>raw</mark>(
    "SELECT * FROM myapp_person"):
    print(p)
</pre>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapse_queryset_returning_operators">
                            Operators that return new QuerySets
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapse_queryset_returning_operators">
                        <div class="accordion-body">
                            <div class="container-fluid">
                                <table class="table table-bordered">
                                    <tr class="table-dark">
                                        <th>Operator</th>
                                        <th>Description</th>
                                        <th>Example Usage</th>
                                    </tr>
                                    <tr>
                                        <th>AND (&)</th>
                                        <td>
                                            Combines two QuerySets using the SQL <em>AND</em> operator in a manner
                                            similar to chaining filters.
                                        </td>
                                        <td>
                                            <pre>
# The following 2 statements are equivalent
Model.objects.filter(x=1) <mark>&</mark> Model.objects.filter(y=2)
Model.objects.filter(x=1).filter(y=2)

# SQL equivalent to the above
SELECT ... WHERE x=1 AND y=2;
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>OR (|)</th>
                                        <td>
                                            Combines two QuerySets using the SQL <em>OR</em> operator.
                                        </td>
                                        <td>
                                            <pre>
# The following 2 statements are equivalent
Model.objects.filter(x=1) <mark>|</mark> Model.objects.filter(y=2)

from django.db.models import Q
Model.objects.filter(Q(x=1) <mark>|</mark> Q(y=2))

# SQL equivalent to the above
SELECT ... WHERE x=1 OR y=2;
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>XOR (^)</th>
                                        <td>Combines two QuerySets using the SQL <em>XOR</em> operator. A XOR expression
                                            matches rows that are matched by an odd number of operands.
                                        </td>
                                        <td>
                                            <pre>
# The following 2 statements are equivalent
Model.objects.filter(x=1) <mark>^</mark> Model.objects.filter(y=2)

from django.db.models import Q
Model.objects.filter(Q(x=1) <mark>^</mark> Q(y=2))

# SQL equivalent to the above
SELECT ... WHERE x=1 XOR y=2;
</pre>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapse_queryset_nonreturning_methods">
                            QuerySet Methods that don't return QuerySets
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapse_queryset_nonreturning_methods">
                        <div class="accordion-body">
                            <div class=container-fluid"">
                                <table class="table table-bordered">
                                    <tr class="table-dark">
                                        <th>Method</th>
                                        <th>Description</th>
                                        <th>Example Usage(s)</th>
                                    </tr>
                                    <tr>
                                        <th>
                                            get()
                                        </th>
                                        <td>
                                            <p>
                                                get(*args, **kwargs) <br>
                                                Asynchronous version: aget()
                                            </p>
                                            <p class="mb-1">
                                                Returns the object matching the given lookup parameters. If no objects
                                                are found that match the criteria, then it raises a
                                                <em>Model.DoesNotExist</em> exception. If more than a single object is
                                                found, then it raises a <em>Model.MultipleObjectsReturned</em>
                                                exception.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.<mark>get</mark>(id=1)

Entry.objects.<mark>get</mark>(Q(blog=blog) & Q(entry_number=1))

# Only use if guaranteed single result
Entry.objects.filter(pk=1).<mark>get</mark>()
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>create()
                                        </th>
                                        <td>
                                            <p>
                                                create(**kwargs) <br>
                                                Asynchronous version: acreate(**kwargs) <br>
                                            </p>
                                            <p class="mb-1">
                                                A convenience method for creating an object and saving it all in a
                                                single step.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
p = Person(first_name="John",
           last_name="Doe")
p.save(force_insert=True)

# Below code is equivalent to the above
p = Person.objects.<mark>create</mark>(first_name="John",
                          last_name="Doe")
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>get_or_create()
                                        </th>
                                        <td>
                                            <p>
                                                get_or_create(defaults=None, **kwargs) <br>
                                                aget_or_create(defaults=None, **kwargs) <br>
                                                Asynchronous version: aget_or_create()
                                            </p>
                                            <p class="mb-1">
                                                A convenience method for looking up an object with the given kwargs (may
                                                be empty if the model has defaults for all fields), creating one if
                                                necessary. Returns a tuple of <em>(object, created)</em>, where
                                                <em>object</em> is the created or updated object, and <em>created</em>
                                                is a boolean specifying whether a new object was created.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
try:
    obj = Person.objects.get(first_name="John",
                             last_name="Lennon")
except Person.DoesNotExist:
    obj = Person(first_name="John",
                 last_name="Lennon",
                 birthday=date(1940,10,9))
    obj.save()

# Below code avoids the race condition of above
obj, created = Person.objects.<mark>get_or_create</mark>(
    first_name = "John",
    last_name ="Lennon",
    defaults={"birthday":date(1940,10,9)}
)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>update_or_create()</th>
                                        <td>
                                            <p>
                                                update_or_create(defaults=None, create_defaults=None, **kwargs) <br>
                                                aupdate_or_create(defaults=None, create_defaults=None, **kwargs)
                                            </p>
                                            <p class="mb-1">
                                                A convenience method for updating an object with the given kwargs,
                                                creating a new one if necessary. The <em>defaults</em> and
                                                <em>create_defaults</em> parameters are dictionaries of (field, value)
                                                pairs. <em>defaults</em> is used to update the object while
                                                <em>create_defaults</em> are used for object creation. If
                                                <em>create_defaults</em> is not supplied, then the <em>defaults</em>
                                                value will be used for the create operation. Returns a tuple of
                                                <em>(object, created)</em>, where <em>object</em> is the created or
                                                updated object, and <em>created</em> is a boolean specifying whether a
                                                new object was created.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
defaults = {"first_name": "Bob"}
create_defaults = {"first_name": "Bob",
                   "birthday":date(1900,1,1)}
try:
    obj = Person.objects.get(first_name="John",
                             last_name="Lennon")
    for key,value in defaults.items():
        setattr(obj, key, value)
    obj.save()
except Person.DoesNotExist:
    new_values = {"first_name":"John",
                  "last_name":"Lennon"}
    new_values.update(create_defaults)
    obj = Person(**new_values)
    obj.save()

# Below code is identical to above code
obj, created = Person.objects.<mark>update_or_create</mark>(
    first_name="John",
    last_name="Lennon",
    defaults={"first_name":"Bob"},
    create_defaults = {"first_name": "Bob",
                       "birthday":date(1900,1,1)}
)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>bulk_create()</th>
                                        <td>
                                            <p>
                                                bulk_create(objs, batch_size=None, ignore_conflicts=False,
                                                update_conflicts=False, update_fields=None, unique_fields=None)<br>
                                                abulk_create(objs, batch_size=None, ignore_conflicts=False,
                                                update_conflicts=False, update_fields=None, unique_fields=None)
                                            </p>
                                            <p class="mb-1">
                                                This method inserts the provided list of objects into the database in an
                                                efficient manner (generally a single query, no matter how many objects),
                                                and returns created object as a list, in the same order as provided. The
                                                <em>batch_size</em> parameter is used to specify how many
                                                objects are created in a single query.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
objs = Entry.objects.<mark>bulk_create</mark>(
    [
        Entry(headline="This is a test"),
        Entry(headline="Only a test")
    ]
)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>bulk_update()</th>
                                        <td>
                                            <p>
                                                bulk_update(objs, fields, batch_size=None)<br>
                                                abulk_update(objs, fields, batch_size=None)
                                            </p>
                                            <p class="mb-1">
                                                This method efficiently updates the given fields on the provided models
                                                instances, generally with one query, and returns the number of objects
                                                updated. The <em>batch_size</em> parameter is used to specify how many
                                                objects are saved in a single query. The default behavior is to update
                                                all objects in a single batch, except for SQLite and Oracle which have
                                                restrictions on the number of variables used in a query. Uses
                                                <em>QuerySet.update()</em> to save changes, which is more efficient than
                                                iterating through the list of models and calling <em>save()</em> on each
                                                one. The model's primary key cannot be updated using this method.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
objs = [
    Entry.objects.create(headline="Entry 1")
    Entry.objects.create(headline="Entry 2")
]
objs[0].headline = "This is entry 1"
objs[1].headline = "This is entry 2"
Entry.objects.<mark>bulk_update</mark>(objs, ["headline"]
>>> 2
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>count()</th>
                                        <td>
                                            <p>
                                                count()<br>
                                                acount()
                                            </p>
                                            <p class="mb-1">
                                                Returns an integer representing the number of objects in the database
                                                matching the QuerySet.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.<mark>count</mark>()

Entry.objects.filter(headline__contains="Lennon").<mark>count</mark>()
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>in_bulk()</th>
                                        <td>
                                            <p>
                                                in_bulk(id_list=None, *, field_name='pk')<br>
                                                ain_bulk(id_list=None, *, field_name='pk')
                                            </p>
                                            <p class="mb-1">
                                                Takes a list of field values (id_list) and the field_name for those
                                                values, and returns a dictionary mapping each value to an instance of
                                                the object with the given field value.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Blog.objects.<mark>in_bulk</mark>([])
{}

Blog.objects.<mark>in_bulk</mark>([1])
{1: &lt;Blog: Beatles Blog&gt;}

Blog.objects.<mark>in_bulk</mark>([1,2])
{1: &lt;Blog: Beatles Blog&gt;,
 2: &lt;Blog: Cheddar Talk&gt;}

Blog.objects.<mark>in_bulk</mark>()
{1: &lt;Blog: Beatles Blog&gt;,
 2: &lt;Blog: Cheddar Talk&gt;,
 3: &lt;Blog: Django Weblog&gt;}

Blog.objects.<mark>in_bulk</mark>(["beatles_blog"], field_name="slug")
{'beatles_blog': &lt;Blog: Cheddar Talk&gt;}
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>iterator()</th>
                                        <td>
                                            <p>
                                                iterator(chunk_size=None)<br>
                                                aiterator(chunk_size=None)
                                            </p>
                                            <p class="mb-1">
                                                Evaluates the QuerySet (by performing the query) and returns an iterator
                                                over the results.
                                            </p>
                                            <!-- <p><strong>With server-side cursors</strong></p>-->
                                            <!-- <p><strong>Without server-side cursors</strong></p>-->
                                        </td>
                                        <td>
                                            <pre>
queryset_iter = Entry.objects.all().<mark>iterator</mark>()
for obj in  queryset_iter:
    print(obj.pub_date)
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>latest()</th>
                                        <td>
                                            <p>
                                                latest(*fields)<br>
                                                alatest(*fields)
                                            </p>
                                            <p class="mb-1">
                                                Returns the latest object in the table based on the given field(s).
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.<mark>latest</mark>("pub_date")

# If 2+ matching pub_date, then sort by -expire_date
Entry.objects.<mark>latest</mark>("pub_date", "-expire_date")
# ( - ) signifies sorting in descending order
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>earliest()</th>
                                        <td>
                                            <p>
                                                earliest(*fields)<br>
                                                aearliest(*fields)
                                            </p>
                                            <p class="mb-1">
                                                Returns the earliest object in the table based on the given field(s).
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.<mark>earliest</mark>("pub_date")

# If 2+ matching pub_date, then sort by -expire_date
Entry.objects.<mark>earliest</mark>("pub_date", "-expire_date")
# ( - ) signifies sorting in descending order
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>first()</th>
                                        <td>
                                            <p>
                                                first()<br>
                                                afirst()
                                            </p>
                                            <p class="mb-1">
                                                Returns the first object in the queryset. Returns <u>None</u> if empty.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
p = Article.objects.order_by("title", "pub_date").<mark>first</mark>()
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>last()</th>
                                        <td>
                                            <p>
                                                last()<br>
                                                alast()
                                            </p>
                                            <p class="mb-1">
                                                Returns the last object in the queryset. Returns <u>None</u> if empty.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
p = Article.objects.order_by("title", "pub_date").<mark>last</mark>()
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>aggregate()</th>
                                        <td>
                                            <p>
                                                aggregate(*args, **kwargs) <br>
                                                aaggregate(*args, **kwargs)
                                            </p>
                                            <p class="mb-1">
                                                Returns a dictionary of aggregate values (averages, sums, etc..)
                                                calculated over the QuerySet. Returns a dictionary with a key-value pair
                                                consisting of the keyword argument and the resulting value of the
                                                calculation.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
from django.db.models import Count
Blog.objects.<mark>aggregate</mark>(Count("entry"))
>> {'entry__count': 16}
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>exists()</th>
                                        <td>
                                            <p>
                                                exists()<br>
                                                aexists()
                                            </p>
                                            <p class="mb-1">
                                                Returns True if the QuerySet contains any results, and False, if not.
                                                It's useful for searches relating the existence of any objects in a
                                                QuerySet, particularly in the context of a large QuerySet.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
if some_queryset.<mark>exists</mark>():
    print("There's at least a single object")
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>contains()</th>
                                        <td>
                                            <p>
                                                contains(obj)<br>
                                                acontains(obj)
                                            </p>
                                            <p class="mb-1">
                                                Returns True if the QuerySet contains obj, and False, if not. It's
                                                useful for checking an object's member in a QuerySet, particularly in
                                                the context of a large QuerySet.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
if some_queryset.<mark>contains</mark>(obj):
    print("Entry found")
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>update()</th>
                                        <td>
                                            <p>
                                                update(**kwargs)<br>
                                                aupdate(**kwargs)
                                            </p>
                                            <p>
                                                Performs a SQL update query for the specified fields, and reutrns the
                                                number of rows matches (which may not be equal to the number of rows
                                                updated if some rows already have the new value). Doesn't work on
                                                related models.
                                            </p>
                                            <p class="mb-1">
                                                <strong>Ordered Queryset</strong>. Chaining order_by() with update().
                                                Only supported on MariaDB and MySQL. Used to update a unique field in
                                                the order that is specified without conflicts.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
Entry.objects.filter(pub_date__year=2010)
             .<mark>update</mark>(comments_on=False)

Entry.objects.filter(pub_date__year=2010)
             .<mark>update</mark>(comments_on=False, headline="OLD!")

# Doesn't work on related models:
<s>Entry.objects.<mark>update</mark>(blog__name="foo")</s>
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>delete()</th>
                                        <td>
                                            <p>
                                                delete()<br>
                                                adelete()
                                            </p>
                                            <p class="mb-1">
                                                Performs a SQL delete query on all rows in the QuerySet and returns the
                                                number of objects deleted and dictionary with the number of dleetions
                                                per object type.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
blogs = Blog.objects.all()
blogs.<mark>delete</mark>()

b = Blog.objects.get(pk=1)
Entry.objets.filter(blog=b).<mark>delete</mark>()
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>as_manager()</th>
                                        <td>
                                            <p>
                                                &lt;classmethod&gt;.as_manager()
                                            </p>
                                            <p class="mb-1">
                                                Class method that returns an instance of Manager with a copy of the
                                                QuerySet's methods. <span class="unfamiliar_topic">Advanced topic,
                                                review this another time. Refer to this
                                                <a href="https://docs.djangoproject.com/en/5.0/topics/db/managers/#creating-a-manager-with-queryset-methods">site</a>
                                                for a detailed explanation.
                                            </span>
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
class PersonManager(models.Manager):
    def get_queryset(self):
        return PersonQuerySet(self.model, using=self._db)
    def authors(self):
        return self.get_queryset().authors()
    def editors(self):
        return self.get_queryset().editors()

# below Manager instance is virtually identical to above:
class Person(models.Model):
    ...
    people = PersonQuerySet.<mark>as_manager</mark>()
</pre>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>explain()</th>
                                        <td>
                                            <p>
                                                explain(format=None, **options)<br>
                                                aexplain(format=None, **options)
                                            </p>
                                            <p class="mb-1">
                                                Returns a string of the QuerySet's execution plan, which details how the
                                                database would execute the query, including any indexes or joins that
                                                would be used. Knowing these details can help with improving the
                                                performance of slow queries. Each SQL engine may handle the output
                                                differently. It is not supported by Oracle.
                                            </p>
                                        </td>
                                        <td>
                                            <pre>
print(Blog.objects.filter(title="My Blog").<mark>explain</mark>())
</pre>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-control mb-2">
            <a id="slice_syntax_anchor"><h4>Limiting QuerySets - using the <em>slice</em> syntax</h4></a>
            <p class="mb-1">
                Python's array-slicing syntax can be used to limit the resulting QuerySet to a certain number/range of
                results. This is equivalent to SQL's <em>LIMIT</em> and <em>OFFSET</em> clauses. The following example
                is equivalent to SQL's <em>LIMIT 5</em> clause and returns the first 5 objects:
            </p>
            <pre class="mb-1">
    Entry.objects.all()[:5]
</pre>
            <p class="mb-1">
                The next example returns the 6th through 10th objects (SQL equivalent: <em>OFFSET 5 LIMIT 5)</em>:
            </p>
            <pre>
    Entry.objects.all()[5:10]
</pre>
            <p class="mb-1">
                Although QuerySet slicing conforms to most of Python's array-slicing syntax, it does not support
                negative indexing (e.g. <code>Entry.objects.all()[-1]</code>).
            </p>
            <p class="mb-1">
                While slicing returns a new QuerySet, it does not evaluate the query. However, if we use the
                <em>step</em> parameter of the slice syntax, then it actually executes the query. The following example
                executes the query and returns the every second object of the first 10 objects:
            </p>
            <pre>
    Entry.objects.all()[:10:2]
</pre>
            <p class="mb-1">
                After a QuerySet has been sliced, <em>filter()</em> and <em>exclude()</em> can no longer be applied to
                it.
                <br>
                To retrieve a single object rather than a list (e.g. <em>SELECT foo FROM bar LIMIT 1</em>), we can use
                an index instead of a slice.
                <br>
                Example using an index:
            </p>
            <pre class="mb-0">
    Entry.objects.order_by("headline")[0]
</pre>
            <p class="my-0">is equivalent to using a slice and <em>get()</em>:</p>
            <pre class="mb-0">
    Entry.objects.order_by("headline")[0:1].get()
</pre>
            <p class="mb-0">
                If the index example fails, it will result in an <em>IndexError</em> exception while a failed
                <em>get()</em> will result in a <em>DoesNotExist</em> exception.
            </p>
        </div>

        <div class="form-control mb-2">
            <a id="field_lookups_anchor"><h4>Field Lookups</h4></a>
            <p class="mb-1">
                Field lookups are keyword arguments to the <em>filter()</em>, <em>exclude()</em>, and <em>get()</em>
                methods. They execute the same or closely to how SQL WHERE clauses do. The syntax of a field lookup:
            </p>
            <pre class="mb-1">
    <em>model_class</em>.objects.filter(<em>field_name</em>__<em>lookup_type</em>="<em>value</em>")
</pre>
            <p class="mb-1">
                The field specified in a lookup has to be the name of a model field. The one exception being in the case
                of a <em>ForeignKey</em>. You can specify the field name suffixed with <em>_id</em> ( single underscore:
                _ ). In this case, the value parameter is expected to contain the raw value of the foreign model's
                primary
                key.
            </p>
            <p>
                Note the double underscore ( __ ) between <em>field_name</em> and <em>lookup_type</em>. This is part of
                the syntax - it separates the field/column name from the lookup type (e.g. contains, in, startswith,
                endswith, etc..). See full list of field lookups below:
            </p>
            <div class="accordion mb-2">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapse_field_lookups">
                            Table of Field Lookups
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapse_field_lookups">
                        <div class="accordion-body">
                            <table class="table table-bordered">
                                <tr class="table-dark">
                                    <th>Field Lookup</th>
                                    <th>Description</th>
                                    <th>Example Usage</th>
                                    <th>SQL Equivalent</th>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">exact</th>
                                    <td>
                                        Searches for an exact match to the specified value in the given column. If
                                        the provided value is <u>None</u>, it will be interpreted as a SQL
                                        <u>NULL</u>.
                                    </td>
                                    <td>
                                        <pre>
Entry.objects.get(id__exact=14)

Entry.objects.get(id__exact=None)
</pre>
                                    </td>
                                    <td>
                                        <pre>
SELECT ...WHERE id = 14;

SELECT ...WHERE id IS NULL;
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">iexact</th>
                                    <td>A variation of <em>exact</em> that is case-insensitive.</td>
                                    <td>
                                        <pre class="mb-0">
Blog.objects.get(
        name__iexact="BeepBoop")

Blog.objects.get(
        name__iexact=None)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE name
    ILIKE 'beepboop';

SELECT ... WHERE name
    IS NULL;
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">contains</th>
                                    <td>Case-sensitive search for the specified pattern in a column.</td>
                                    <td>
                                        <pre>
Entry.objects.get(
    headline__contains="Lemon")
</pre>
                                    </td>
                                    <td>
                                        <pre>
SELECT ... WHERE headline
    LIKE '%Lemon%';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">icontains</th>
                                    <td>Case-insensitive search for the specified pattern in a column.</td>
                                    <td>
                                        <pre>
Entry.objects.get(
    headline__icontains="Lemon")
</pre>
                                    </td>
                                    <td>
                                        <pre>
SELECT ... WHERE headline
    ILIKE '%Lennon%';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">in</th>
                                    <td>Checks to see if a value exists in a given iterable (e.g. list, tuple,
                                        queryset).
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(id__in=[1,10,100])

Entry.objects.filter(headline__in="abc")

inner_qs = Blog.objects.filter(
                name__contains="Cheddar")
entries = Entry.objects.filter(
                blog__in=inner_qs)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE id IN (1,10,100);

SELECT ... WHERE headline
    IN ('a','b','c');

SELECT ... WHERE blog.id
    IN (SELECT id FROM ...
        WHERE name LIKE '%Cheddar%');
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">gt, gte</th>
                                    <td><em>gt</em> = greater than. <br><em>gte</em> = greater than or equal to.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(id__gt=4)

Entry.objects.filter(id__gte=4)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT .. WHERE id > 4;

SELECT .. WHERE id >= 4;
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">lt, lte</th>
                                    <td><em>lt</em> = less than. <br><em>lte</em> = less than or equal to.</td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(id__lt=4)

Entry.objects.filter(id__lte=4)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT .. WHERE id < 4;

SELECT .. WHERE id <= 4;
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">startswith</th>
                                    <td>Case-sensitive search for records that start with the specified value.</td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            headline__startswith="Che")
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE headline LIKE 'Che%';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">istartswith</th>
                                    <td>Case-insensitive search for records that start with the specified value.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            headline__istartswith="Che")
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE headline ILIKE 'Che%';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">endswith</th>
                                    <td>Case-sensitive search for records that end with the specified value.</td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            headline__endswith="ddar")
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE headline LIKE '%ddar';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">iendswith</th>
                                    <td>Case-insensitive search for records that end with the specified value.</td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            headline__iendswith="ddar")
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE headline ILIKE '%ddar';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">range</th>
                                    <td>
                                        Searches for records whose value falls between two specified values. Can be
                                        type, numeric, string, or dates.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
import datetime
start_day = datetime.date(2024,1,1)
end_day = datetime.date(2024,3,1)
Entry.objects
    .filter(pub_date__range=(start_day,
                             end_day))
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE pub_date
    BETWEEN '2024-01-01' AND '2024-03-01';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">date</th>
                                    <td>For datetime fields, casts the value as a date and searches the records for
                                        an exact match. Allows chaining additional field lookups. Takes a date
                                        value.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
get_day = datetime.date(2024,1,1)
Entry.objects.filter(
            pub_date__date=get_day)

Entry.objects.filter(
            pub_date__date__gt=get_day)
</pre>
                                    </td>
                                    <td>
                                        <p class="mb-1">
                                            (No equivalent SQL statement because implementation is handled
                                            differently between SQL engines.)
                                        </p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">year</th>
                                    <td>For date and datetime fields, casts the value as a year and searches the
                                        records for an exact match. Allows chaining additional field lookups.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__year=2024)


Entry.objects.filter(
            pub_date__year__gte=2024)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE pub_date
    BETWEEN '2024-01-01' AND '2024-12-31';

SELECT ... WHERE pub_date >= '2024-01-01';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">iso_year</th>
                                    <td>For date and datetime fields, casts the value as an ISO 8601 week-numbering
                                        year and searches the records for an exact match. Allows chaining additional
                                        field lookups. Takes an integer year.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__iso_year=2024)

Entry.objects.filter(
            pub_date__iso_year__gte=2024)
</pre>
                                    </td>
                                    <td>
                                        <p class="mb-1">(Excluded because SQL syntax varies between SQL engines)</p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">month</th>
                                    <td>
                                        <p class="mb-1">
                                            For date and datetime fields, casts the value as a month and searches the
                                        records for an exact match. Allows chaining additional field lookups. Takes
                                        an integer between 1 (Jan) and 12 (Dec).
                                        </p>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__month=12)

Entry.objects.filter(
            pub_date__month__gte=6)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE
    EXTRACT('month' FROM pub_date) = '12';

SELECT ... WHERE
    EXTRACT('month' FROM pub_date) >= '6';
</pre>
                                        <p class="mt-2">(EXTRACT command is currently only supported by MySQL,
                                            Oracle, PostgreSQL, and Firebird.)
                                        </p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">day</th>
                                    <td>For date and datetime fields, casts the value as a day and searches the
                                        records for an exact match. Allows chaining additional field lookups. Takes
                                        an integer day.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__day=3)

Entry.objects.filter(
            pub_date__day__gte=3)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE
    EXTRACT('day' FROM pub_date) = '3';

SELECT ... WHERE
    EXTRACT('day' FROM pub_date) >= '3';
</pre>
                                        <p class="mt-2">
                                            (EXTRACT command is currently only supported by MySQL, Oracle,
                                            PostgreSQL, and Firebird.)
                                        </p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">week</th>
                                    <td>For date and dateime fields, returns the week number (1-52 or 52) according
                                        to ISO-8601, i.e., weeks start on a Monday and the first week contains the
                                        year's first Thursday. Allows chaining additional field lookups.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__week=52)

Entry.objects.filter(
            pub_date__week__gte=32,
            pub_date__week__lte=38)
</pre>
                                    </td>
                                    <td>
                                        <p class="mb-1">(Excluded because SQL syntax varies between SQL engines)</p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">week_day</th>
                                    <td>For date and datetime fields, a 'day of the week' match. Allows chaining
                                        additional field lookups. Takes an integer value representing the day of the
                                        week from 1 (Sunday) to 7 (Saturday).
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__week_day=2)

Entry.objects.filter(
            pub_date__week_day__gte=2)
</pre>
                                    </td>
                                    <td>
                                        <p class="mb-1">(Excluded because SQL syntax varies between SQL engines)</p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">iso_week_day</th>
                                    <td>For date and datetime fields, an exact ISO-8601 day of the week match.
                                        Allows chaining additional field lookups. Takes an integer value
                                        representing the
                                        day of the week from 1 (Monday) to 7 (Sunday).
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__iso_week_day=1)

Entry.objects.filter(
            pub_date__week_day__gte=1)
</pre>
                                    </td>
                                    <td>
                                        <p class="mb-1">(Excluded because SQL syntax varies between SQL engines)</p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">quarter</th>
                                    <td>For date and datetime fields, a quarter of the year match. Allows chaining
                                        additional field lookups. Takes an integer value between 1 and 4
                                        representing the quarter of the year. For example, 2 is second quarter which
                                        is from April 1 to June 30.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
            pub_date__quarter=2)
</pre>
                                    </td>
                                    <td>
                                        <p class="mb-1">(Excluded because SQL syntax varies between SQL engines)</p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">time</th>
                                    <td>For datetime fields, casts the value as time. Allows chaining additional
                                        field lookups. Takes a datetime.time value.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
        pub_date__time=datetime.time(14,30))

Entry.objects.filter(
                pub_date__time__range=(
                    datetime.time(8),
                    datetime.time(17)))
</pre>
                                    </td>
                                    <td>
                                        <p class="mb-1">(Excluded because SQL syntax varies between SQL engines)</p>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">hour</th>
                                    <td>For datetime and time fields, an exact hour match. Allows chaining
                                        additional field lookups. Takes an integer between 0 and 23.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Event.objects.filter(
            timestamp__hour=23)

Event.objects.filter(
            time__hour=5)

Event.objects.filter(
            timestamp__hour__gte=12)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE
    EXTRACT('hour' FROM timestamp) = '23';

SELECT ... WHERE
    EXTRACT('hour' FROM time) = '5';

SELECT ... WHERE
    EXTRACT('hour' FROM timestamp) >= '12';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">minute</th>
                                    <td>For datetime and time fields, an exact minute match. Allows chaining
                                        additional field lookups. Takes an integer between 0 and 59.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Event.objects.filter(
            timestamp__minute=29)

Event.objects.filter(
            time__minute=46)

Event.objects.filter(
            timestamp__minute__gte=29)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE
    EXTRACT('minute' FROM timestamp) = '29';

SELECT ... WHERE
    EXTRACT('minute' FROM time) = '46';

SELECT ... WHERE
    EXTRACT('minute' FROM timestamp) >= '29';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">second</th>
                                    <td>For datetime and time fields, an exact second match. Allows chaining
                                        additional field lookups. Takes an integer between 0 and 59.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Event.objects.filter(
            timestamp__second=31)

Event.objects.filter(
            time__second=2)

Event.objects.filter(
            timestamp__second__gte=31)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE
    EXTRACT('second' FROM timestamp) = '31';

SELECT ... WHERE
    EXTRACT('second' FROM time) = '2';

SELECT ... WHERE
    EXTRACT('second' FROM timestamp) >= '31';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">isnull</th>
                                    <td>Takes either True or False, which correspond to SQL queries of IS NULL and
                                        IS NOT NULL, respectively.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.filter(
                pub_date__isnull=True)
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
SELECT ... WHERE pub_date IS NULL;
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">regex</th>
                                    <td>
                                        Case-sensitive regular expression match.
                                        <br>
                                        The regular expression syntax is that of the database backend in use. In the
                                        case of SQLite, which has no built in regular expression support, this
                                        feature is provided by a (Python) user-defined REGEXP function, and the
                                        regular expression syntax is therefore that of Pythons re module.
                                    </td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.get(
        title__regex=r"^(An?|The) +")
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
# MySQL
SELECT ... WHERE title
    REGEXP BINARY '^(An?|The) +';

# Oracle
SELECT ... WHERE title
    REGEXP_LIKE(title,
                '^(An?|The) +',
                'c');

# PostgreSQL
SELECT ... WHERE title
    ~ '^(An?|The) +';

# Sqlite
SELECT ... WHERE title
    REGEXP '^(An?|The) +';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="align-middle text-center">iregex</th>
                                    <td>Case-insensitive regular expression match.</td>
                                    <td>
                                        <pre class="mb-0">
Entry.objects.get(
        title__iregex=r"^(an?|the) +")
</pre>
                                    </td>
                                    <td>
                                        <pre class="mb-0">
# MySQL
SELECT ... WHERE title
    REGEXP '^(an?|the) +';

# Oracle
SELECT ... WHERE title
    REGEXP_LIKE(title,
                '^(an?|the) +',
                'i');

# PostgreSQL
SELECT ... WHERE title
    ~* '^(an?|the) +';

# Sqlite
SELECT ... WHERE title
    REGEXP '^(?i)^(an?|the) +';
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="4">
                                        <a href="https://docs.djangoproject.com/en/5.0/ref/models/querysets/#field-lookups">
                                            Field Lookups Reference Source
                                        </a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-control mb-2">
            <a id="lookups_span_relationships_anchor"><h4>Lookups that span relationships</h4></a>
            <p class="mb-1">
                Django offers a way to "follow" relationships (e.g. <em>ForeignKey</em>, <em>ManyToManyField</em>,
                etc..) in lookups, acting similarly to how SQL <em>JOIN</em>s work. To span a relationship, use the
                field name of the related fields across models, separated by double underscores ( __ ), until we get the
                field we want. The following example retrieves all <em>Entry</em> objects with a <em>Blog</em> whose
                <em>name</em> is <u>"Beetle Blog"</u>:
            </p>
            <pre class="mb-2">
    # models.py
    ...
    class Entry(models.Model):
        blog = models.ForeignKey(Blog, on_delete=models.CASCADE)
        headline = models.CharField(max_length=255)
        ...
    class Blog(models.Model):
        name = models.CharField(max_length=100)
        tagline = models.TextField()
        ...
    ...
</pre>
            <pre>
    # views.py
    Entry.objects.filter(blog__name="Beetle Blog")
</pre>
            <div class="form-control mb-2">
                <a id="reverse_relationship_anchor"><h5>Reverse Relationship</h5></a>
                <p class="mb-1">
                    The above spanning can be as deep as desired and can work backwards as well. While it can be
                    customized, by default you refer to a "reverse" relationship in a lookup by using the lowercase name
                    of the model. The following example retrieves all <em>Blog</em> objects which have at least one
                    <em>Entry</em> whose <em>headline</em> contains <u>"Lemon"</u>:
                </p>
                <pre>
    Blog.objects.filter(entry__headline__contains="Lemon")
</pre>
                <p class="mb-1">
                    If filtering across multiple relationships and one of the intermediate models doesn't have a value
                    that meets the filter condition, Django will treat it as if there is an empty (all values are
                    <em>NULL</em>), but valid, object there. No error will be raised. Example:
                </p>
                <pre>
    Blog.objects.filter(entry__authors__name="Lemon")
</pre>
                <p class="mb-1">
                    In the above example, even though there is no related <em>Author</em> model, no error is raised. If
                    we used the <em>isnull</em> field lookup, then we may encounter an unusual situation in which
                    <em>Blog</em> objects are returned which have an empty <em>name</em> for the <em>author</em> as well
                    as objects with an empty <em>author</em> on the <em>entry</em>. See below for an example of this:
                </p>
                <pre>
    Blog.objects.filter(entry__authors__name__isnull=True)
</pre>
                <p class="mb-1">
                    If we want to use <em>isnull</em> but avoid these objects, then it can be rewritten, like so:
                </p>
                <pre>
    Blog.objects.filter(entry__authors__isnull=False, entry__authors__name__is_null=True)
</pre>
            </div>

            <div class="form-control mb-1">
                <a id="span_multivalue_relationships_anchor"><h5>Spanning Multi-valued Relationships</h5></a>
                <p class="mb-1">
                    If spanning a <em>ManyToManyField</em> or a reverse <em>ForeignKey</em> (e.g. from <em>Blog</em> to
                    <em>Entry</em>) relationship, it is worth considering whether we want each attribute to coincide on
                    the same related object. To select all blogs containing at least one entry from <u>2008</u> having
                    <u>"Lennon"</u> in its headline (the same entry satisfying both conditions):
                </p>
                <pre>
    Blog.objects.filter(entry__headline__contains="Lennon", entry__pub_date__year=2008)
    # Requires objects to match BOTH conditions
</pre>
                <p class="mb-1">
                    Otherwise, to perform a more permissive query selecting any <em>blog</em> objects with a
                    <em>headline</em> of <u>"Lemon"</u> and any <em>entry</em> objects with a <em>pub_date</em> of
                    <u>2008</u>, we can use the following example:
                </p>
                <pre>
    Blog.objects.filter(entry__headline__contains="Lennon")
                .filter(entry__pub_date__year=2008)
    # Requires objects to match the first condition
</pre>
                <p class="mb-1">
                    The downside is that this query chains multiple filters, performing multiple joins to the primary
                    model, potentially yielding duplicates.
                </p>
                <p class="mb-0">Another example:</p>
                <pre class="mb-2">
    from datetime import date

    beatles = Blog.objects.create(name="Beatles Blog")
    pop = Blog.objects.create(name="Pop Music Blog")

    Entry.objects.create(
        blog=beatles,
        headline="New Lennon Biography",
        pub_date=date(2008, 6, 1))
    &lt;Entry: New Lennon Biography&gt;

    Entry.objects.create(
        blog=beatles,
        headline="New Lennon Biography in Paperback",
        pub_date=date(2009, 6, 1))
    &lt;Entry: New Lennon Biography in Paperback&gt;

    Entry.objects.create(
        blog=pop,
        headline="Best Albums of 2008",
        pub_date=date(2008, 12, 15))
    &lt;Entry: Best Albums of 2008&gt;

    Entry.objects.create(
        blog=pop,
        headline="Lennon Would Have Loved Hip Hop",
        pub_date=date(2020, 4, 1))
    &lt;Entry: Lennon Would Have Loved Hip Hop&gt;
</pre>
                <hr class="my-1">
                <pre>
    Blog.objects.filter(
        entry__headline__contains="Lennon",
        entry__pub_date__year=2008)
    &lt;QuerySet [&lt;Blog: Beatles Blog&gt;]&gt;
    <mark># ("New Lennon Biography",2008)</mark>

    Blog.objects.filter(entry__headline__contains="Lennon")
                .filter(entry__pub_date__year=2008)
    &lt;QuerySet [&lt;Blog: Beatles Blog&gt;, &lt;Blog: Beatles Blog&gt;, &lt;Blog: Pop Music Blog]&gt;
    <mark># ("New Lennon Biography",2008),("New Lennon Biography in Paperback",2009),("Lennon Would Have Loved Hip Hop",2020)</mark>
</pre>
                <p class="unfamiliar_topic">
                    This chaining filters example is confusing. What is the purpose of the second filter (year=2008), if
                    it returns "New Lennon Biography" and "Lennon Would Have Loved Hip Hop"? Neither of these entries
                    have a <em>pub_date</em> of <u>2008</u>. According to the provided explanation, it is because the
                    second filter (year=2008) may not be looking at the same <em>entry</em> objects from the first
                    filter (headline="Lennon"). BUT, if this is the case, then why wasn't "Best Albums of 2008" also
                    represented in the results? Even if we first filter by the date, then "New Lennon Biography" and
                    "Lennon Would Have Loved Hip Hop" wouldn't show up because they're not from 2008.
                </p>
                <p class="mb-0">
                    Another example scenario:
                </p>
                <div class="form-control mb-2">
                    Assume there is a single <em>blog</em> that contains <em>entry</em> objects containing
                    <u>"Lennon"</u> as well as <em>entry</em> objects from <u>2008</u> BUT there's no overlap. The first
                    query would not return the <em>blog</em>. The second query would return the blog. This is because
                    the <em>entry</em> objects selected by the second filter may or may not be the same as the
                    <em>entry</em> objects in the first filter. It is the <em>Blog</em> items that are being filtered
                    and not the <em>Entry</em> items. In short, if each condition needs to match the same related
                    object, then each should be contained in a single <em>filter()</em> call.
                </div>
                <div class="form-control mb-1">
                    <a id="filter_vs_exclude_anchor"><h5><em>filter()</em> vs <em>exclude()</em> in queries that span
                        multi-value relationships</h5></a>
                    <p class="mb-1">
                        The behavior of <em>filter()</em> for queries that span multi-value relationships is not
                        implemented
                        equivalently for <em>exclude()</em>. The below example is our 'first query' referenced earlier
                        but
                        with the <em>include()</em> call replaced with <em>exclude()</em>:
                    </p>
                    <pre class="mb-1">
    Blog.objects.<mark>exclude</mark>(
        entry__headline__contains="Lennon",
        entry__pub_date__year=2008)
</pre>
                    <p class="mb-1">
                        Unlike the behavior of the 'first query' where it requires a match to <strong>all</strong>
                        specified
                        filters, the above example will exclude blogs that match <strong>either</strong> condition. To
                        exclude objects that match <strong>both</strong> conditions, then we can use a filter to
                        retrieve
                        those objects, then use <em>exclude()</em> on them. See below:
                    </p>
                    <pre class="mb-1">
    Blog.objects.<mark>exclude</mark>(
        entry__in=Entry.objects.<mark>filter</mark>(
            entry__headline__contains="Lennon",
            entry__pub_date__year=2008)
    )
</pre>
                </div>
            </div>
        </div>

        <div class="form-control mb-2">
            <a id="f_expressions_anchor"><h4>Filters Referencing Fields on the Model - Using <em>F expressions</em></h4>
            </a>
            <p>
                In the previous sections, we discussed filters that compare the value of a model field with a constant
                value. If we want to compare the value of a model field with another model field on the same model, then
                we can use <em>F expressions</em>. To start using <em>F expressions</em>, we need to import the module
                using the following command:
                <br>
                <code>&nbsp;&nbsp;&nbsp;&nbsp;from django.db.models import F</code>
            </p>
            <p class="mb-1">
                Instances of <em>F()</em> act as a reference to a model field within a query. These references can be
                used in query filters to compare the values of two different fields on the same model instance. The
                below example is used to find a list of <em>blog</em> entries whose <em>number_of_comments</em> value is
                larger than their <em>number_of_pingbacks</em> value:
            </p>
            <pre>
    from django.db.models import F
    Entry.objects.filter(number_of_comments__gt=F("number_of_pingbacks"))
</pre>
            <p class="mb-1">
                Django supports the use of addition, subtraction, multiplication, division, modulo, and power arithmetic
                operations with <em>F()</em> objects, both with constants and with other <em>F()</em> objects. For
                example, if we want to find <em>blog</em> entries whose <em>number_of_comments</em> value is twice or
                more than the <em>number_of_pingbacks</em> value, see below query:
            </p>
            <pre>
    Entry.objects.filter(number_of_comments__gt=F("number_of_pingbacks") * 2)
</pre>
            <p class="mb-1">
                This example query finds all <em>blog</em> entries where the <em>rating</em> value is less than the sum
                of the <em>number_of_comments</em> and <em>number_of_pingbacks</em> values:
            </p>
            <pre>
    Entry.objects.filter(rating__lt=F("number_of_comments") + F("number_of_pingbacks"))
</pre>
            <p class="mb-1">
                <em>F expressions</em> can also be used to span relationships by using the double underscore notation (
                __ ). An <em>F()</em> object with double underscore will introduce any joins needed to access the
                related object. The example query below retrieves all entries whose <em>author</em> value matches the
                <em>blog</em> name:
            </p>
            <pre>
    Entry.objects.filter(authors__name=F("blog__name"))
</pre>
            <p class="mb-1">
                For date/time fields, you can add or subtract a <em>timedelta</em> object. The following example returns
                all entries that were modified more than 3 days after they were published (i.e. <em>mod_date</em> is 3
                or more days later than the <em>pub_date</em>.
            </p>
            <pre>
    from datetime import timedelta
    Entry.objects.filter(mod_date__gt=F("pub_date") + timedelta(days=3))
</pre>
            <p class="mb-1">
                Bitwise operations such as <em>.bitand()</em>, <em>.bitor()</em>, <em>.bitxor()</em>
                <small>(Not supported in Oracle)</small>, <em>.bitrightshift()</em>, and <em>.bitleftshift()</em> are
                also supported. See example snippet below:
            </p>
            <pre class="mb-0">
    F("somefield").bitand(16)
</pre>
        </div>

        <div class="form-control mb-2">
            <a id="f_expressions_reference_xform_anchor"><h4>Referencing Transforms with <em>F Expressions</em></h4></a>
            <p class="mb-1">
                <em>F expressions</em> can also incorporate the use of transforms
                <span class="unfamiliar_topic">(is this the same as applying a field lookup? In the example below, they
                    use a <em>year</em> field lookup so... maybe?)</span>. See example below:
            </p>
            <pre>
    from django.db.models import F
    Entry.objects.filter(pub_date__year=F("mod_date__year"))
</pre>
            <p class="mb-1">
                The below example query locates the earliest year that an entry was published. Note that it uses
                <em>aggregate()</em> <em>Min()</em>, which hasn't been covered yet.
            </p>
            <pre>
    from django.db.models import Min
    Entry.objects.aggregate(first_published_year=Min("pub_date__year"))
</pre>
            <p class="mb-1">
                The next example finds the highest rated entry and the total number of comments on all entries for a
                year. Again, uses functions/modules which haven't been discussed: <em>OuterRef</em>,
                <em>SubQuery</em>,
                <em>Sum</em>, <em>annotate</em>, <em>order_by</em>, and <em>values</em>.
            </p>
            <pre class="mb-0">
    from django.db.models import OuterRef, Subquery, Sum
    Entry.objects.values("pub_date__year").annotate(
        top_rating=Subquery(
            Entry.objects.filter(
                pub_date__year=OuterRef("pub_date__year")
            ).order_by("-rating").values("rating")[:1]
        ),
        total_comments=Sum("number_of_comments")
    )
</pre>
        </div>

        <div class="form-control mb-2">
            <a id="pk_lookup_shortcut_anchor"><h4><em>pk</em> Lookup Shortcut</h4></a>
            <a href="https://docs.djangoproject.com/en/5.0/topics/db/queries/#the-pk-lookup-shortcut"></a>
            <p class="mb-1">
                <em>pk</em>, short for "primary key", is a unique identifier for each record in a database. Each record
                in a Django model has a field which serves as its primary key, and regardless of its name, it can be
                referred to as "pk".
            </p>
            <pre>
    # Explicit form:
    Blog.objects.get(id__exact=14)

    # __exact is implied
    Blog.objects.get(id=14)

    # implies id__exact
    Blog.objects.get(pk=14)
</pre>
            <p class="mb-1">
                The use of <em>pk</em> isn't limited to <em>__exact</em> queries - any query item can be combined with
                <em>pk</em> to perform a query on the primary key of a model:
            </p>
            <pre>
    # selects records with id of 1, 4, and 7
    Blog.objects.filter(pk__in=[1,4,7])

    # selects records with id greater than 14
    Blog.objects.filter(pk__gt=[14])
</pre>
            <p class="mb-1">
                <em>pk</em> lookups also work across joins. Below queries are equivalent:
            </p>
            <pre class="mb-0">
    Entry.objects.filter(blog__id__exact=3)
    Entry.objects.filter(blog__id=3)
    Entry.objects.filter(blog__pk=3)
</pre>
        </div>

        <!--        <div class="form-control mb-2">-->
        <!--            <h4>Escaping percent signs and undercores in LIKE statements</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre class="mb-2">-->
        <!--~-->
        <!--</pre>-->
        <!--        </div>-->

        <!--        <div class="form-control mb-2">-->
        <!--            <h4>Caching and QuerySets</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre class="mb-2">-->
        <!--~-->
        <!--</pre>-->
        <!--            <div class="form-control mb-2">-->
        <!--                <h5>When QuerySets are not cached</h5>-->
        <!--                <p class="mb-1">-->
        <!--                    ~-->
        <!--                </p>-->
        <!--                <pre class="mb-2">-->
        <!--~-->
        <!--</pre>-->
        <!--            </div>-->
        <!--        </div>-->
        <!--    </div>-->

        <!--    <div class="form-control mb-2">-->
        <!--        <h3>Asynchronous Queries</h3>-->
        <!--        <p class="mb-1">-->
        <!--            ~-->
        <!--        </p>-->
        <!--        <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--        <div class="form-control mb-2">-->
        <!--            <h4>Query Iteration</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--        </div>-->

        <!--        <div class="form-control mb-2">-->
        <!--            <h4>QuerySet and Manager Methods</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--        </div>-->

        <!--        <div class="form-control mb-2">-->
        <!--            <h4>Transactions</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--        </div>-->
        <!--    </div>-->

        <!--    <div class="form-control mb-2">-->
        <!--        <h3>Querying JSONField</h3>-->
        <!--        <p class="mb-1">-->
        <!--            ~-->
        <!--        </p>-->
        <!--        <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--        <div class="form-control mb-2">-->
        <!--            <h4>Storing and querying for None</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--        </div>-->

        <!--        <div class="form-control mb-2">-->
        <!--            <h4>Key, index, and path transforms</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--            <div class="form-control mb-2">-->
        <!--                <h5>KT() Expressions</h5>-->
        <!--                <p class="mb-1">-->
        <!--                    ~-->
        <!--                </p>-->
        <!--                <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--            </div>-->
        <!--        </div>-->

        <!--        <div class="form-control mb-2">-->
        <!--            <h4>Containment and key lookups</h4>-->
        <!--            <p class="mb-1">-->
        <!--                ~-->
        <!--            </p>-->
        <!--            <pre>-->
        <!--~-->
        <!--</pre>-->
        <!--        </div>-->
        <!--    </div>-->

        <div class="form-control mb-2">
            <a id="q_objects_anchor"><h4><em>Q</em> Objects</h4></a>
            <p>
                A <em>Q object</em> (or <em>Q() object</em>) is an object used to encapsulate a collection of keyword
                arguments. These keyword arguments are specified in the <a href="#field_lookups_anchor">field lookups
                section</a>.
            </p>
            <p>
                <em>Q objects</em> represent SQL condition(s) that can be used in database-related operations. It bears
                some similarity to <em>F()</em> objects in how it represents the values of a model field or annotation.
                They make it possible to define and reuse conditions, and combine them using operators such as
                <em>&</em>, <em>|</em>, and <em>^</em> (AND, OR, and XOR, respectively).
            </p>
            <p class="mb-1">
                When multiple keyword argument queries are used in methods like <em>filter()</em> and <em>exclude()</em>,
                they are joined by an underlying <em>SQL AND</em> operation. More complex queries (e.g. queries with
                <em>SQL OR</em> statements), can be executed by using <em>Q() objects</em>.
                <br>
                In the below example, the <em>Q object</em> encapsulates a single <em>LIKE</em> query:
            </p>
            <pre>
    from django.db.models import Q
    Q(question__startswith="What")
</pre>
            <p class="mb-1">
                <em>Q</em> objects can be combined using the <em>&</em>, <em>|</em>, and <em>^</em> operators. When an
                operator is used on two (or more) <em>Q</em> objects, it yields a new <em>Q</em> object. The below
                queries are joined by an <em>OR</em> ( | ) operator and result in a new Q object:
            </p>
            <pre class="mb-1">
    Q(question__startswith="Who") | Q(question__startswith="What")
</pre>
            <p class="mb-1">The above is equivalent to the following <em>SQL WHERE</em> clause snippet:</p>
            <pre>
    WHERE question LIKE 'Who%' OR question LIKE 'What%'
</pre>
            <p class="mb-1">
                We can compose statements of arbitrary complexity by combining Q objects with the &, |, and ^ operators
                and use parentheses to group them. Additionally, Q objects can be negated using the <em>NOT</em>
                operator ( ~ ), thus allowing for combined lookups that combine both a normal and negated query. See
                below for an example of this:
            </p>
            <pre>
    Q(question__startswith="Who") | ~Q(pub_date__year=2005)
</pre>
            <p class="mb-1">
                Lookup functions like <em>filter()</em>, <em>exclude()</em>, and <em>get()</em> can be passed one or
                more
                <em>Q</em> objects as positional (unnamed) arguments. If multiple Q objects arguments are provided to a
                lookup function, the arguments will be joined with an <em>AND</em> operation. See example below:
            </p>
            <pre class="mb-1">
    Poll.objects.get(
        Q(question__startswith="Who"),
        Q(pub_date=date(2005,5,2)) | Q(pub_date=date(2005,5,7))
    )
</pre>
            <p class="mb-1">The above query is roughly equivalent to the below SQL statement:</p>
            <pre>
    SELECT * FROM polls WHERE question
            LIKE 'Who%'
            AND (pub_date = '2005-05-02' OR pub_date = '2005-05-07');
</pre>
            <p>
                Lookup functions can mix the use of Q objects and keyword arguments. All arguments provided to a lookup
                function (keyword arguments or Q objects) are combined using an AND operation. However, if a Q object is
                provided, it must precede the definition of any keyword arguments. See example below:
            </p>
            <pre class="mb-0">
# valid query - Q object precedes the keyword argument
Poll.objects.get(
    Q(pub_date=date(2005,5,2)) | Q(pub_date=date(2005,5,7)),
    question__startswith="Who"
)

# invalid query - Q object is preceded by a non-Q argument
<s>Poll.objects.get(
    question__startswith="Who",
    Q(pub_date=date(2005,5,2)) | Q(pub_date=date(2005,5,7))
)</s>
</pre>
        </div>

        <div class="form-control mb-2">
            <a id="compare_objs_anchor"><h4>Comparing objects</h4></a>
            <p class="mb-1">
                Model instances can be compared using the Python comparison operator ( == ). This compares the primary
                key
                values of each object against each other. Note that the name of the primary key does not matter. Example
                usage:
            </p>
            <pre class="mb-1">
    some_entry == other_entry
    some_entry.id == other_entry.id # This is equivalent to the above statement
</pre>
        </div>

        <div class="form-control mb-2">
            <a id="delete_objs_anchor"><h4>Deleting objects</h4></a>
            <p class="mb-1">
                The delete method immediately deletes the objects and returns the number of objects deleted and a
                dictionary with the number of deletions per object type. Objects can also be deleted in bulk.
                <br>
                Example:
            </p>
            <pre class="mb-1">
    b = Blog.objects.get(pk=1)
    b.<mark>delete</mark>()

    Entry.objects.filter(pub_date__year=2005).<mark>delete</mark>()

    Entry.objects.all().<mark>delete</mark>()
</pre>
        </div>

        <div class="form-control mb-2">
            <a id="copy_objs_anchor"><h4>Copying model instances</h4></a>
            <p class="mb-1">
                There isn't a built-in method for copying model instance but it is possible to easily create new
                instances with all fields' values copied. Below example is the simplest way to copy a model instance and
                requires setting <em>pk</em> to <u>None</u> and <em>_state.adding</em> to <u>True</u>:
            </p>
            <pre class="mb-1">
    blog = Blog(name="My Blog", tagline="Blogging is easy")
    blog.save()

    blog.pk = None
    blog._state.adding = True
    blog.save()
</pre>
            <p class="mb-2">
                For more complex/sophisticated variations of model instance copying, refer to this
                <a href="https://docs.djangoproject.com/en/5.0/topics/db/queries/#copying-model-instances">guide</a>.
            </p>
        </div>

        <div class="form-control mb-2">
            <a id="update_multiple_objs_anchor"><h4>Updating multiple objects simultaneously</h4></a>
            <p class="mb-1">
                Using the <em>update()</em> method, we can set a field to a particular value for all objects in a
                QuerySet. The below example updates all <em>headline</em>s with <em>pub_date</em> of <u>2007</u>:
            </p>
            <pre>
    Entry.objects.filter(pub_date__year=2007).update(headline="Same same")
</pre>
            <p class="mb-1">
                Only non-related and ForeignKey fields can be set in this way. To update a non-relation field,
                the new value must be a constant. To update ForeignKey fields, set the new value to be the new model
                instance. Below example changes every Entry so that it belongs to the Blog object:
            </p>
            <pre>
    b = Blog.objects.get(pk=1)
    Entry.objects.update(blog=b)
</pre>
            <p class="mb-1">
                The <em>update()</em> method is applied instantly and returns the number of rows matched by the query
                (may not be equal to the number of rows updated because some of the rows may already have that value).
                The only restriction on the QuerySet being updated is that it can only access one database table: the
                model's main table. We can filter based on related fields, but can only update columns in the model's
                main table. Below example updates all headlines belonging to the Blog object:
            </p>
            <pre>
    b = Blog.objects.get(pk=1)
    Entry.objects.filter(blog=b).update(headline="Same same")
</pre>
            <p class="mb-1">
                The <em>update()</em> method is a bulk operation for direct updates. This method is converted directly
                to a SQL statement. It doesn't run any <em>save()</em> methods on the models or emit the
                <em>pre_save</em> or <em>post_save</em> isngals, or honor the <em>auto_now</em> field option. To save
                every item in a QuerySet and make sure that the <em>save()</em> method is called on each instance, we
                need to loop over them and call <em>save()</em>. See example below:
            </p>
            <pre>
    for item in my_queryset:
        item.save()
</pre>
            <p class="mb-1">
                <em>F expressions</em> are also permitted with the caveat that they can only be used for local fields -
                related are not permitted. See below:
            </p>
            <pre class="mb-0">
    Entry.objects.update(number_of_pingbacks=F("number_of_pingbacks") + 1)

    # This one will cause a FieldError to be raised
    Entry.objects.update(headline=F("blog__name"))
</pre>
        </div>

        <div class="form-control mb-2">
            <a id="related_objs_anchor"><h4>Related Objects</h4></a>
            <p class="mb-1">
                Instances of models in a relationship (i.e. ForeignKey, OneToOneField, or ManyToManyField) have access
                to related objects via an API. Using the reference <a href="#example_modelspy_id">example</a>, we can
                see that the model instances of <em>Entry</em> can access the associated <em>Blog</em> object by
                accessing the <em>blog</em> attribute. Example:
            </p>
            <pre>
    entry_obj.blog
</pre>
            <p class="mb-1">
                Django also creates API accessors for the "other" side of the relationship - the link from the related
                model to the model that defines the relationship. For example, a <em>Blog</em> object has access to a
                list of all <em>Entry</em> objects via the <em>entry_set</em> attribute:
            </p>
            <pre>
    blog_object.entry_set.all()
</pre>
            <div class="form-control mb-2">
                <a id="onetomany_relationship_anchor"><h5>One-to-Many Relationships</h5></a>
                <div class="form-control mb-2">
                    <h6>Forward</h6>
                    <p class="mb-1">
                        If a model has a <em>ForeignKey</em>, instances of that model will have access to the related
                        (foreign) object via an attribute of the model. Example:
                    </p>
                    <pre>
    e = Entry.objects.get(id=2)
    e.blog                                          # returns the related Blog object
</pre>
                    <p class="mb-1">
                        Retrieval and setting is done via the foreign-key attribute. Changes to the foreign key aren't
                        saved to the database until the <em>save()</em> method is called. Example:
                    </p>
                    <pre>
    e = Entry.objects.get(id=2)
    e.blog = some_blog
    e.save()
</pre>
                    <p class="mb-1">
                        If a <em>ForeignKey</em> field has <em>null=True</em> set (i.e. allows <u>NULL</u> values), then
                        we can assign <u>None</u> to remove the relation. Example:
                    </p>
                    <pre>
    e = Entry.objects.get(id=2)
    e.blog = None
    e.save()                                        # UPDATE blog_entry SET blog_id = NULL ...;
</pre>
                    <p class="mb-1">
                        Forward access to one-to-many relationships is cached the first time the related object is
                        accessed. Subsequent accesses to the foreign key on the same object instance are cached.
                        Example:
                    </p>
                    <pre>
    e = Entry.objects.get(id=2)
    print(e.blog)                                   # Hits the database to retrieve the associated blog
    print(e.blog)                                   # Doesn't hit the database; uses the cached version
</pre>
                    <p class="mb-1">
                        The <em>select_related() QuerySet</em> method recursively prepopulates the cache of all
                        one-to-many relationships ahead of time. Example:
                    </p>
                    <pre class="mb-1">
    e = Entry.objects.<mark>select_related</mark>().get(id=2)
    print(e.blog)                                   # Doesn't hit the database; uses the cached version
    print(e.blog)                                   # Doesn't hit the database; uses the cached version
</pre>
                </div>
                <div class="form-control mb-2">
                    <h6>Following relationships "backward"</h6>
                    <p class="mb-1">
                        If a model has a <em>ForeignKey</em>, instances of the foreign-key model will have access
                        to a <em>Manager</em> that returns all instances of the first model. By default, this
                        <em>Manager</em> is named <em>FOO_set</em>, where <em>FOO</em> is the source model name,
                        lowercased. This <em>Manager</em> returns <em>QuerySets</em>, which can be filtered and
                        manipulated as described in the <a href="#manager_anchor">Retrieving Objects section</a>. Example:
                    </p>
                    <pre>
    b = Blog.objects.get(id=1)
    b.entry_set.all()                               # returns all Entry objects related to Blog

    # b.<mark>entry_set</mark> is a Manager that returns QuerySets
    b.<mark>entries</mark>.filter(headline__contains="Lennon")
    b.<mark>entries</mark>.count()
</pre>
                    <p class="mb-1">
                        The <em>FOO_set</em> name can be overriden by setting the <em>related_name</em> parameter in the
                        <em>ForeignKey</em> definition. Example:
                    </p>
                    <pre class="mb-1">
    # Example alteration to models.py for demonstration:
    # (added parameter 'related_name')
    class Entry(models.Model):
        blog = ForeignKey(Blog, on_delete=models.CASCADE, related_name='entries')
    ...

    b = Blog.objects.get(id=1)                      # returns all Entry objects related to Blog

    # b.<mark>entries</mark> is a Manager that returns QuerySets
    b.<mark>entries</mark>.filter(headline__contains="Lennon")
    b.<mark>entries</mark>.count()
</pre>
                </div>
                <div class="form-control mb-2">
                    <h6>Using a custom reverse manager</h6>
                    <p class="mb-1">
                        By default, the <em>RelatedManager</em> used for reverse relations is a subclass of the default
                        manager for that model. To specify a different manager for a given query, we can use the
                        following syntax:
                    </p>
                    <pre>
    from django.db import models
    class Entry(models.Model):
        ...
        objects = models.Manager()                  # Default Manager
        entries = EntryManager()                    # Custom Manager

    b = Blog.objects.get(id=1)
    b.entry_set(manager="entries").all()
</pre>
                    <p>
                        If <em>EntryManager</em> performed default filtering in its <em>get_queryset()</em> method, that
                        filtering would apply to the <em>all()</em> call.
                    </p>
                    <p class="mb-1">
                        Specifying a custom reverse manager also enables calling its custom methods:
                    </p>
                    <pre class="mb-1">
    b.entry_set(manager="entries").is_published()
</pre>
                </div>
                <div class="form-control mb-1">
                    <h6>Additional methods to handle related objects</h6>
                    <table class="table table-bordered mb-1">
                        <tr>
                            <th>add(obj1, obj2, ...)</th>
                            <td>Add the specified model objects to the related object set.</td>
                        </tr>
                        <tr>
                            <th>create(**kwargs)</th>
                            <td>Creates a new object, saves it and puts it in the related object set. Returns the newly
                                created object.
                            </td>
                        </tr>
                        <tr>
                            <th>remove(obj1, obj2, ...)</th>
                            <td>Removes the specified model objects from the related object set.</td>
                        </tr>
                        <tr>
                            <th>clear()</th>
                            <td>Removes all objects from the related object set.</td>
                        </tr>
                        <tr>
                            <th>set(objs)</th>
                            <td>Replace the set of related objects.</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="form-control mb-2">
                <a id="manytomany_relationships_anchor"><h5>Many-to-Many Relationships</h5></a>
                <p class="mb-1">
                    Both ends of a many-to-many relationship get automatic API access to the other end. This API works
                    similar to a "backward" one-to-many relationship.
                </p>
                <div class="form-control mb-1">
                    <h6>Difference between many-to-many and one-to-many relationships</h6>
                    <p class="mb-1">
                        One difference is in the attribute naming - the model that defines the <em>ManyToManyField</em>
                        uses the attribute name of that field itself, whereas the "reverse" model uses the lowercased
                        model name of the original model, plus '<em>_set</em>' (same as reverse one-to-many
                        relationship). Example:
                    </p>
                    <pre class="mb-1">
    e = Entry.objects.get(id=3)
    e.authors.all()                                 # returns all Author objects for this Entry
    e.authors.count()
    e.authors.filter(name__contains="John")

    a = Author.objects.get(id=5)
    a.entry_set.all()                               # returns all Entry objects for this Author
</pre>
                    <p>
                        Similar to <em>ForeignKey</em>, <em>ManyToManyField</em> can specify <em>related_name</em>. In
                        the above example, if the <em>ManyToManyField</em> in <em>Entry</em> had specified
                        <em>related_name='entries'</em>, then each <em>Author</em> instance would have an
                        <em>entries</em> attribute instead of <em>entry_set</em>.
                    </p>
                    <p class="mb-1">
                        Another difference from one-to-many relationships is that in addition to model instance, the
                        <em>add()</em>, <em>set()</em>, and <em>remove()</em> methods on many-to-many relationships
                        accept primary key values. In the below example, if we assume <em>e1</em> and <em>e2</em> are
                        <em>Entry</em> instances, then the <em>set()</em> calls work identically:
                    </p>
                    <pre class="mb-2">
    a = Author.objects.get(id=5)
    a.entry_set.set([e1, e2])
    a.entry_set.set([e1.pk, e2.pk])
</pre>
                </div>
            </div>

            <div class="form-control mb-1">
                <a id="onetoone_relationships_anchor"><h5>One-to-One Relationships</h5></a>
                <p class="mb-1">
                    One-to-one relationships are similar to many-to-one relationships. If a <em>OneToOneField</em> is
                    defined on a model, then instances of that model will have access to the related object via an
                    attribute of the model. Example:
                </p>
                <pre>
    class EntryDetail(models.Model):
        entry = models.OneToOneField(Entry, on_delete=models.CASCADE)
        details = models.TextField()

    ed = EntryDetail.objects.get(id=2)
    ed.entry # returns the related Entry object.
</pre>
                <p class="mb-1">
                    The difference between this one-to-one and the many-to-one relationship is the way it handles
                    "reverse" queries. The related model in a one-to-one relationship also has access to a
                    <em>Manager</em> object, but that <em> Manager</em> represents a single object, rather than a
                    collection of objects. Example:
                </p>
                <pre class="mb-1">
    e = Entry.objects.get(id=2)
    e.entrydetails                                  # returns the related EntryDetail object
</pre>
                <p>
                    If no object has been assigned to this relationship, Django will raise a <em>DoesNotExist</em>
                    exception.
                </p>
                <p class="mb-1">
                    Instances can be assigned to the reverse relationship in the same way as one would assign the
                    forward relationship:
                </p>
                <pre class="mb-1">
    e.entrydetail = ed
</pre>
            </div>
        </div>

        <div class="form-control mb-2">
            <a id="raw_sql_anchor"><h3>Performing Raw SQL Queries</h3></a>
            <p class="mb-1">
                The <em>Manager</em> has a function named <em>raw()</em> that allows us to pass in a SQL statement. This
                is <u>high risk</u> and is generally not recommended except as a last-ditch measure. Using raw SQL
                incurs the potential risk of SQL injection attacks. If still intending to use it, utilize SQL injection
                protection techniques. See guide <a
                    href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">here</a>.
                Some tips (refer to the linked guide for a detailed breakdown):
            </p>
            <ul>
                <li>Use prepared statements (with parameterized queries)</li>
                <li>Use properly constructed stored procedures</li>
                <li>Allow-list input validation</li>
                <li>(Not recommended) Escape all user-supplied input</li>
            </ul>
            <p class="mb-1">
                Example Usage:
            </p>
            <pre class="mb-1">
    class Person(models.Model):
        first_name = models.CharField(...)
        last_name = models.CharField(...)
        birth_date = models.DateField(...)

    for p in Person.objects.<mark>raw</mark>("SELECT * FROM myapp_person"):
        print(p)
</pre>
        </div>

        <div class="form-control mb-2">
            <a id="aggregate_and_annotate_anchor"><h3>Using <em>aggregate()</em> and <em>annotate()</em></h3></a>
            <p>
                Aggregating and annotating objects refers to summing up or putting together the values. Annotation of an
                object creates a separate summary for each object in a queryset. Aggregation of an object is to generate
                summary values over an <strong>entire</strong> QuerySet. The difference between <em>annotate()</em> and
                <em>aggregate()</em> is that the former applies the query to each individual item and attaches that
                result to each individual item, while the latter applies the query upon the entire QuerySet as a whole
                and returns a single result (as a key-value pair in a dictionary).
            </p>

            <p class="mb-1">
                Below are some commonly used aggregation functions that can be used with <em>aggregate()</em> and
                <em>annotate()</em>. See the full list <a href="#aggregation_functions_anchor">here</a>.
            </p>
            <table class="table table-bordered mb-2">
                <tr>
                    <th>Count()</th>
                    <td>Returns the number of related objects</td>
                </tr>
                <tr>
                    <th>Sum()</th>
                    <td>Returns the sum of a field's values</td>
                </tr>
                <tr>
                    <th>Avg()</th>
                    <td>Returns the average of a field's values</td>
                </tr>
                <tr>
                    <th>Max()</th>
                    <td>Returns the largest value in a field's values</td>
                </tr>
                <tr>
                    <th>Min()</th>
                    <td>Returns the smallest value in a field's values</td>
                </tr>
            </table>

            <div class="form-control mb-2">
                <a id="aggregation_functions_anchor"><h4>Aggregation Functions</h4></a>
                <p>Django provides the following aggregation functions in the <em>django.db.models</em> module.</p>
                <h6 class="mb-1">Common Parameters</h6>
                <p class="mb-1">All aggregate functions have the following parameters in common:</p>
                <div class="accordion mb-2">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#id_aggregate_function_common_parameters">
                                Common Parameters
                            </button>
                        </h2>
                        <div class="accordion-collapse collapse" id="id_aggregate_function_common_parameters">
                            <div class="accordion-body">
                                <table class="table table-bordered">
                                    <tr>
                                        <th>expressions</th>
                                        <td>Strings that reference fields on the model, transforms of the field, or
                                            query expressions.
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>output_field</th>
                                        <td>An optional argument that represents the model field of the return value.
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>filter</th>
                                        <td>An optional Q object that's used to filter the rows that are aggregated.
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>default</th>
                                        <td>
                                            An optional argument that allows specifying a value to use as a default
                                            value when the queryset (or grouping) contains no entries.
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>**extra</th>
                                        <td>Keyword arguments that can provide extra context for the SQL generated by
                                            the aggregate.
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <h6>Full List of Aggregation Functions</h6>
                <div class="accordion mb-2">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#id_aggregation_functions">
                                Aggregation Functions
                            </button>
                        </h2>
                        <div class="accordion-collapse collapse" id="id_aggregation_functions">
                            <div class="accordion-body">
                                <table class="table table-bordered">
                                    <tr>
                                        <th>Avg</th>
                                        <td>
                                            <p>
                                                class Avg(expression, output_field=None, distinct=False, filter=None,
                                                default=None, **extra)
                                            </p>
                                            <p>
                                                Returns the mean value of the given expression, which must be numeric
                                                unless a different <em>output_field</em> is specified.
                                            </p>
                                            <ul>
                                                <li>Default alias: <em>&lt;field&gt;__avg</em></li>
                                                <li>
                                                    Return type: <em>float</em> if input is <em>int</em>, else same as
                                                    input field, or <em>output_field</em>, if supplied. If the queryset
                                                    or grouping is empty, <em>default</em> is returned.
                                                </li>
                                            </ul>
                                            <p class="mb-1">
                                                <em>distinct</em>. Optional. If set to <u>True</u>, the <em>Avg()</em>
                                                returns the mean value of unique values. SQL equivalent is
                                                <em>AVG(DISTINCT &lt;field&gt;)</em>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Count</th>
                                        <td>
                                            <p>class Count(expression, distinct=False, filter=None, **extra)</p>
                                            <p>
                                                Returns the number of objects that are related through the provided
                                                expression. <em>Count('*')</em> is equivalent to the SQL
                                                <em>COUNT(*)</em> expression.
                                            </p>
                                            <ul>
                                                <li>Default alias: <em>&lt;field&gt;__count</em></li>
                                                <li>Return type: <em>int</em></li>
                                            </ul>
                                            <p class="mb-1">
                                                <em>distinct</em>. Optional. If set to <u>True</u>, the count will only
                                                include unique instances. SQL equivalent is
                                                <em>COUNT(DISTINCT &lt;field&gt;)</em>.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Max</th>
                                        <td>
                                            <p>
                                                class Max(expression, output_field=None, filter=None, default=None,
                                                **extra)
                                            </p>
                                            <p>Returns the maximum value of the given expression.</p>
                                            <ul class="mb-1">
                                                <li>Default alias: <em>&lt;field&gt;__max</em></li>
                                                <li>
                                                    Return type: same as the input field, or <em>output_field</em>, if
                                                    supplied. If the queryset or grouping is empty, then
                                                    <em>default</em> is returned.
                                                </li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Min</th>
                                        <td>
                                            <p>
                                                class Min(expression, output_field=None, filter=None, default=None,
                                                **extra)
                                            </p>
                                            <p>Returns the minimum value of the given expression.</p>
                                            <ul class="mb-1">
                                                <li>Default alias: <em>&lt;field&gt;__min</em></li>
                                                <li>
                                                    Return type: same as the input field, or <em>output_field</em>, if
                                                    supplied. If the queryset or grouping is empty, then
                                                    <em>default</em> is returned.
                                                </li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>StdDev</th>
                                        <td>
                                            <p>
                                                class StdDev(expression, output_field=None, sample=False, filter=None,
                                                default=None, **extra)
                                            </p>
                                            <p>Returns the standard deviation of the data in the provided
                                                expression.</p>
                                            <ul>
                                                <li>Default alias: <em>&lt;field&gt;__stddev</em></li>
                                                <li>
                                                    Return type: <em>float</em> if input is <em>int</em>, otherwise same
                                                    as the input field, or <em>output_field</em> if supplied. If the
                                                    queryset or grouping is empty, <em>default</em> is returned.
                                                </li>
                                            </ul>
                                            <p class="mb-1">
                                                <em>sample</em>. Optional. By default, <em>StdDev</em> returns the
                                                population standard deviation. However, if <em>sample=True</em>, the
                                                return value will be the sample standard deviation.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Sum</th>
                                        <td>
                                            <p>
                                                class Sum(expression, output_field=None, distinct=False, filter=None,
                                                default=None, **extra)
                                            </p>
                                            <p>Computes the sum of all values of the given expression.</p>
                                            <ul>
                                                <li>Default alias: <em>&lt;field&gt;__sum</em></li>
                                                <li>
                                                    Return type: same as the input field, or <em>output_field</em>, if
                                                    supplied. If the queryset or grouping is empty, then
                                                    <em>default</em> is returned.
                                                </li>
                                            </ul>
                                            <p class="mb-1">
                                                <em>distinct</em>. Optional. If set to <u>True</u>, <em>Sum</em> returns
                                                the sum of unique values. SQL equivalent is
                                                <em>SUM(DISTINCT &lt;field&gt;)</em>. The default value is <u>False</u>.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Variance</th>
                                        <td>
                                            <p>
                                                class Variance(expression, output_field=None, sample=False, filter=None,
                                                default=None, **extra)
                                            </p>
                                            <p>Returns the variance of the data in the provided expression.</p>
                                            <ul>
                                                <li>Default alias: <em>&lt;field&gt;__variance</em></li>
                                                <li>
                                                    Return type: <em>float</em> if input is <em>int</em>, otherwise same
                                                    as the input field, or <em>output_field</em> if supplied. If the
                                                    queryset or grouping is empty, <em>default</em> is returned.
                                                </li>
                                            </ul>
                                            <p class="mb-1">
                                                <em>sample</em>. Optional. By default, <em>Variance</em> returns the
                                                population variance. However, if <em>sample=True</em>, the return value
                                                will be the sample variance.
                                            </p>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-control mb-2">
                <a id="annotate_anchor"><h4>Using annotate()</h4></a>
                <p>
                    <em>annotate()</em> is a QuerySet method that allows adding annotations to each item in the
                    queryset. These annotations can be aggregations, calculations, or any other type of additional data
                    to be attached. Annotation of an object creates a separate summary for each object in a queryset. In
                    short, it is a tool that can be used to perform aggregation, add computed fields, and more to your
                    query results.
                </p>
                <p class="mb-1">
                    Example of using annotate to count how many books each author has written:
                </p>
                <pre class="mb-1">
    from django.db.models import Count
    authors = Author.objects.annotate(num_books=Count('book'))
    for author in authors:
        print(author.name, author.num_books)
</pre>
            </div>

            <div class="form-control mb-1">
                <a id="aggregate_anchor"><h4>Using aggregate()</h4></a>
                <p class="mb-2">
                    <em>aggregate()</em> is a QuerySet method that combines the records of the fields to get a summary
                    of the queryset. It allows us to retrieve values that are derived by summarizing (aggregating) a
                    collection of objects. Thes example below are commonly used aggregate queries. For a comprehensive
                    guide on aggregation, refer to this
                    <a href="https://docs.djangoproject.com/en/5.0/topics/db/aggregation/">site</a>.
                </p>

                <div class="form-control mb-2">
                    <h6>Example models.py for reference:</h6>
                    <pre class="mb-1">
    from django.db import models
    class Author(models.Model):
        name = models.CharField(max_length=100)
        age = models.IntegerField()

    class Publisher(models.Model):
        name = models.CharField(max_length=300)

    class Book(models.Model):
        name = models.CharField(max_length=300)
        pages = models.IntegerField()
        price = models.DecimalField(max_digits=10, decimal_places=2)
        rating = models.FloatField()
        authors = models.ManyToManyField(Author)
        publisher = models.ForeignKey(Publisher, on_delete=models.CASCADE)
        pubdate = models.DateField()

    class Store(models.Model):
        name = models.CharField(max_length=300)
        books = models.ManyToManyField(Book)
</pre>
                </div>

                <p class="mb-1">Example usages:</p>
                <pre class="mb-1">
    # Total number of books
    Book.objects.count()
    # 2452

    # Total number of books with publisher="BaloneyPress"
    Book.objects.filter(publisher__name="BaloneyPress").count()
    # 73

    # Average price across all books, provides a default to be returned if no books
    from django.db.models import Avg
    Book.objects.aggregate(Avg("price", default=0))
    # {'price__avg': 34.35}

    # Max price across all books, provides a default to be returned if no books
    from django.db.models import Max
    Book.objects.aggregate(Max("price", default=0))
    # {'price__max': Decimal('81.20')}

    # Difference between the highest priced book and the average price of all books
    from django.db.models import FloatField
    Book.objects.aggregate(price_diff=Max("price", output_field=FloatField()) - Avg("price"))
    # {'price_diff': 46.85}

    # The below queries involve traversing the Book<-Publisher foreign key relationship backwards

    # Each publisher, each with a count of books as a 'num_books" attribute
    from django.db.models import Count
    pubs = Publisher.objects.annotate(num_books=Count("book"))

    >>> pubs
    # &lt;QuerySet [&lt;Publisher: BaloneyPress&gt;, &lt;Publisher: SalamiPress&gt;, ...]&gt;

    >>>pubs[0].num_books
    # 73

    # Each publisher, with two separate counts: books with a rating above 5 and books at 5 and below
    from django.db.models import Q
    above_5 = Count("book", filter=Q(book__rating__gt=5))
    below_or_equal_to_5 = Count("book", filter=Q(book__rating__lte=5))
    pubs = Publisher.objects.annotate(below_or_equal_to_5=below_or_equal_to_5).annotate(above_5=above_5)

    >>> pubs[0].above_5
    # 23

    >>> pubs[0].below_or_equal_to_5
    # 1323
</pre>
            </div>
        </div>

        <div class="form-control mb-1">
            <a id="anchor_evaluating_querysets">
                <h3>Evaluating QuerySets</h3>
            </a>
            <p class="mb-1">
                Internally, a <strong>QuerySet</strong> can be constructed, filtered, sliced, and generally passed
                around without updating the database. No database activity actually occurs until something is done to
                evaluate the queryset.
                <br>
                A <em>QuerySet</em> can be evaluated in the following ways:
            </p>

            <div class="accordion mb-2">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#id_queryset_evaluating_actions">
                            Table of Actions that Evaluate QuerySets
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="id_queryset_evaluating_actions">
                        <div class="accordion-body">
                            <table class="table table-bordered">
                                <tr class="table-dark">
                                    <th></th>
                                    <th>Description</th>
                                    <th>Example usage</th>
                                </tr>
                                <tr>
                                    <th>Iteration</th>
                                    <td>
                                        A QuerySet is iterable, and it executes its database query the first time it is
                                        iterated over.
                                    </td>
                                    <td>
                                <pre class="mb-0">
for e in Entry.objects.all():
    print(e.headline)
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Asynchronous Iteration</th>
                                    <td>A QuerySet can be iterated over using <em>async for</em>. Both synchronous and
                                        asynchronous iterators of QuerySets share the same underlying cache.
                                    </td>
                                    <td>
                                <pre class="mb-0">
async for e in Entry.objects.all():
    results.append(e)
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Slicing</th>
                                    <td>
                                        <p>
                                            A QuerySet can be sliced, using Python's array-slicing syntax. However,
                                            negative indices are not supported. Slicing an unevaluated QuerySet usually
                                            returns another unevaluated QuerySet, but Django will execute the database
                                            query if using the "step" parameter of the slice syntax
                                            <em>( iterable[start : end :
                                                <mark>step</mark>
                                                ] )</em>, thus returning a
                                            list. Slicing a QuerySet that has been evaluated will also return a list.
                                        </p>
                                        <p class="mb-0">
                                            Note: even though slicing an unevaluated QuerySet returns another
                                            unevaluated QuerySet, modifying it further (e.g. adding more filters,
                                            modifying ordering) is not allowed because it does not translate well into
                                            SQL.
                                        </p>
                                    </td>
                                    <td>
                                <pre class="mb-0">
Entry.objects.all()[:5]
Entry.objects.all()[2:5]
Entry.objects.all()[:10:2]
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Pickling/Caching <br>
                                        <span class="unfamiliar_topic">(Requires additional <br> review/study)</span>
                                    </th>
                                    <td>
                                        <p>
                                            <u>Pickling</u> is the process whereby a Python object hierarchy is
                                            converted into a byte stream. <u>Unpickling</u> is the inverse operation,
                                            whereby a byte stream (from a binary file or bytes-like object) is converted
                                            back into an object hierarchy. (Note: unpickling is not secure - only
                                            unpickle data you trust. It is possible to construct malicious pickle data
                                            which will execute arbitrary code during unpickling.)
                                        </p>
                                        <p class="mb-0">
                                            If pickling a QuerySet, it will force all of the results to be loaded into
                                            memory prior to pickling. It is usually used as a precursor to caching and
                                            when the cached queryset is reloaded, the results are immediately present
                                            and ready for use. (Solves the problem of reading from database, which
                                            usually takes some time, defeating the purpose of caching). This means when
                                            unpickling a QuerySet, it contains the results at the moment it was pickled,
                                            rather than the results that are currently in the database.
                                        </p>
                                    </td>
                                    <td>
                                <pre class="mb-0">
import pickle
# Serializes the data and converts to byte stream
pickled_str = pickle.dumps("abcdef")

# Deserializes the byte stream back to the original object
unpickled_str = pickle.loads(pickled_str)

# Restores the original 'query'
qs = MyModel.objects.all()
qs.query = unpickled_str
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th>repr()</th>
                                    <td>A QuerySet will be evaluated when using <em>repr()</em> on it. This is for
                                        convenience in the Python interactive interpreter, so results can be seen
                                        immediately when interacting with the API.<em>repr()</em> returns a printable
                                        representational string of the given object.
                                    </td>
                                    <td>
                                <pre class="mb-0">
repr(Entry.objects.all())
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th>len()</th>
                                    <td>A QuerySet will be evaluated when using <em>len()</em> on it. Returns the length
                                        of the result list. Note: if only the number of records in the set is needed
                                        (and not the actual objects), it is more efficient to handle a count at the
                                        database level using the SQL's <em>SELECT COUNT(*)</em> statement. Django also
                                        provides a <em>count()</em> method for the same reason.
                                    </td>
                                    <td>
                                <pre class="mb-0">
len(Entry.objects.all())
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th>list()</th>
                                    <td>A QuerySet will be evaluated when using <em>list()</em> on it.
                                        <span class="unfamiliar_topic">
                                            This method returns a list...? Django's official API reference guide is
                                            seriously lacking.
                                        </span>
                                    </td>
                                    <td>
                                <pre class="mb-0">
entry_list = list(Entry.objects.all())
</pre>
                                    </td>
                                </tr>
                                <tr>
                                    <th>bool()</th>
                                    <td>
                                        Using <em>bool()</em>, <em>or</em>, <em>and</em>, or an <em>if</em> statement on
                                        a QuerySet will cause the query to be executed. <em>bool()</em> will return
                                        <u>True</u> if there is at least one result, else <u>False</u>. Note: if
                                        checking to see if at least one result existsand don't require the actual
                                        objects), then use the more efficient <em>exists()</em> function:
                                        <pre class="mb-0">some_queryset.exists()</pre>
                                    </td>
                                    <td>
                                <pre class="mb-0">
if Entry.objects.filter(headline="Test"):
    print('At least one headline starts with "Test"');
</pre>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--        <div class="form-control mb-2">-->
        <!--            <h2>REMAINING TOPICS TO COVER</h2>-->
        <!--            <pre class="unfamiliar_topic">-->
        <!--    Func() Expressions-->
        <!--    Aggregate() Expressions-->
        <!--    Value() Expressions-->
        <!--    ExpressionWrapper() Expressions-->
        <!--    Conditional expressions-->
        <!--    Subquery() expressions-->
        <!--    Window functions-->
        <!--</pre>-->
        <!--        </div>-->
    </div>
</div>
{% endblock %}

{% block chapter_block %}
Django - Model Queries
{% endblock %}

{% block glossary_block %}
<li>
    <a class="dropdown-item" href="#django_model_queries_anchor"><strong>Django - Model Queries</strong></a>
</li>
<li>
    <a class="dropdown-item" href="#creating_objs_anchor">Creating Objects</a>
</li>
<li>
    <a class="dropdown-item" href="#update_objs_anchor">Saving Changes to Objects (AKA Updating)</a>
</li>
<li>
    <a class="dropdown-item" href="#save_foreignkey_manytomany_fields_anchor">
        &nbsp;&nbsp;&nbsp;Saving <em>ForeignKey</em> and <em>ManyToManyField</em> Fields
    </a>
</li>
<li>
    <a class="dropdown-item" href="#manager_anchor">Using the <em>Manager (objects)</em></a>
</li>
<li>
    <a class="dropdown-item" href="#retrieve_all_objs_anchor">
        &nbsp;&nbsp;&nbsp;Retrieving All Objects - Using <em>all</em>
    </a>
</li>
<li>
    <a class="dropdown-item" href="#filter_method_anchor">
        &nbsp;&nbsp;&nbsp;Retrieving/Filtering Specific Objects - Using <em>filter</em> and <em>exclude</em>
    </a>
</li>
<li>
    <a class="dropdown-item" href="#chaining_filters_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chaining Filters
    </a>
</li>
<li>
    <a class="dropdown-item" href="#filtered_queryset_unique_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filtered QuerySets are unique
    </a>
</li>
<li>
    <a class="dropdown-item" href="#lazy_querysets_anchor">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QuerySets are lazy</a>
</li>
<li>
    <a class="dropdown-item" href="#single_obj_retrieval_anchor">
        &nbsp;&nbsp;&nbsp;Retrieving a Single Object with <em>get</em>
    </a>
</li>
<li>
    <a class="dropdown-item" href="#queryset_api_methods_anchor">&nbsp;&nbsp;&nbsp;QuerySet API</a>
</li>
<li>
    <a class="dropdown-item" href="#slice_syntax_anchor">
        &nbsp;&nbsp;&nbsp;Limiting QuerySets - using the <em>slice</em> syntax
    </a>
</li>
<li>
    <a class="dropdown-item" href="#field_lookups_anchor">&nbsp;&nbsp;&nbsp;Field Lookups</a>
</li>
<li>
    <a class="dropdown-item" href="#lookups_span_relationships_anchor">
        &nbsp;&nbsp;&nbsp;Lookups that span relationships
    </a>
</li>
<li>
    <a class="dropdown-item" href="#reverse_relationship_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reverse Relationship
    </a>
</li>
<li>
    <a class="dropdown-item" href="#span_multivalue_relationships_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanning Multi-valued Relationships
    </a>
</li>
<li>
    <a class="dropdown-item" href="#filter_vs_exclude_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>filter()</em> vs <em>exclude()</em> in queries that span multi-value
        relationships
    </a>
</li>
<li>
    <a class="dropdown-item" href="#f_expressions_anchor">
        &nbsp;&nbsp;&nbsp;Filters Referencing Fields on the Model - Using <em>F expressions</em>
    </a>
</li>
<li>
    <a class="dropdown-item" href="#f_expressions_reference_xform_anchor">
        &nbsp;&nbsp;&nbsp;Referencing Transforms with <em>F Expressions</em>
    </a>
</li>
<li>
    <a class="dropdown-item" href="#pk_lookup_shortcut_anchor">
        &nbsp;&nbsp;&nbsp;<em>pk</em> Lookup Shortcut
    </a>
</li>
<li>
    <a class="dropdown-item" href="#q_objects_anchor">&nbsp;&nbsp;&nbsp;<em>Q</em> Objects</a>
</li>
<li>
    <a class="dropdown-item" href="#compare_objs_anchor">&nbsp;&nbsp;&nbsp;Comparing objects</a>
</li>
<li>
    <a class="dropdown-item" href="#delete_objs_anchor">&nbsp;&nbsp;&nbsp;Deleting objects</a>
</li>
<li>
    <a class="dropdown-item" href="#copy_objs_anchor">&nbsp;&nbsp;&nbsp;Copying model instances</a>
</li>
<li>
    <a class="dropdown-item" href="#update_multiple_objs_anchor">
        &nbsp;&nbsp;&nbsp;Updating multiple objects simultaneously
    </a>
</li>
<li>
    <a class="dropdown-item" href="#related_objs_anchor">&nbsp;&nbsp;&nbsp;Related Objects</a>
</li>
<li>
    <a class="dropdown-item" href="#onetomany_relationship_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One-to-Many Relationships
    </a>
</li>
<li>
    <a class="dropdown-item" href="#manytomany_relationships_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Many-to-Many Relationships
    </a>
</li>
<li>
    <a class="dropdown-item" href="#onetoone_relationships_anchor">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One-to-One Relationships
    </a>
</li>
<li>
    <a class="dropdown-item" href="#raw_sql_anchor">Performing Raw SQL Queries</a>
</li>
<li>
    <a class="dropdown-item" href="#aggregate_and_annotate_anchor">
        Using <em>aggregate()</em> and <em>annotate()</em>
    </a>
</li>
<li>
    <a class="dropdown-item" href="#aggregation_functions_anchor">&nbsp;&nbsp;&nbsp;Aggregation Functions</a>
</li>
<li>
    <a class="dropdown-item" href="#annotate_anchor">&nbsp;&nbsp;&nbsp;Using annotate()</a>
</li>
<li>
    <a class="dropdown-item" href="#aggregate_anchor">&nbsp;&nbsp;&nbsp;Using aggregate()</a>
</li>
<li>
    <a class="dropdown-item" href="#anchor_evaluating_querysets">Evaluating QuerySets</a>
</li>

{% endblock %}